<Type Name="ServerDocument" FullName="Microsoft.VisualStudio.Tools.Applications.ServerDocument">
  <Metadata><Meta Name="ms.openlocfilehash" Value="9cc94d407ee23e5feed9fb7cc58c715c1236f096" /><Meta Name="ms.sourcegitcommit" Value="7439021cdeee6a9ef5d4640250701344f6cbba15" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="08/13/2019" /><Meta Name="ms.locfileid" Value="68997065" /></Metadata><TypeSignature Language="C#" Value="public sealed class ServerDocument : IDisposable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit ServerDocument extends System.Object implements class System.IDisposable" />
  <TypeSignature Language="DocId" Value="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" />
  <AssemblyInfo>
    <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
    <AssemblyVersion>10.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.IDisposable</InterfaceName>
    </Interface>
  </Interfaces>
  <Docs>
    <summary><span data-ttu-id="949ea-101">提供对文档或工作簿（属于使用 Visual Studio 中的 Office 开发工具创建的文档级自定义项）中的缓存数据和自定义项信息的访问。</span><span class="sxs-lookup"><span data-stu-id="949ea-101">Provides access to the cached data and customization information in a document or workbook that is part of a document-level customization created by using the Office development tools in Visual Studio.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-102"><xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>使用类管理文档级自定义项的某些方面, 该计算机上未安装 Excel 或 Word。</span><span class="sxs-lookup"><span data-stu-id="949ea-102">Use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> class to manage certain aspects of document-level customizations on a computer that does not have Excel or Word installed.</span></span> <span data-ttu-id="949ea-103">通常在不与 Office 集成的应用程序 (例如, 控制台项目或 Windows 窗体项目, 而不是 Office 项目) 中使用此类。</span><span class="sxs-lookup"><span data-stu-id="949ea-103">You typically use this class in applications that do not integrate with Office, such as Console projects or Windows Forms projects, rather than Office projects.</span></span>  
  
 <span data-ttu-id="949ea-104">使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>类的以下成员可以执行常见任务:</span><span class="sxs-lookup"><span data-stu-id="949ea-104">Use the following members of the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> class to perform common tasks:</span></span>  
  
-   <span data-ttu-id="949ea-105">若要访问和修改服务器上文档的数据缓存中的数据, 请使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="949ea-105">To access and modify data in the data cache of a document on a server, use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData%2A> property.</span></span>  
  
-   <span data-ttu-id="949ea-106">若要以编程方式将自定义项附加到文档或从文档中移除自<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>定义<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization%2A>项, 请使用和方法。</span><span class="sxs-lookup"><span data-stu-id="949ea-106">To programmatically attach a customization to a document or remove a customization from a document, use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> and <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization%2A> methods.</span></span>  
  
-   <span data-ttu-id="949ea-107">若要访问或更改与文档关联的部署清单的 URL, 请使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.DeploymentManifestUrl%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="949ea-107">To access or change the URL of the deployment manifest that is associated with the document, use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.DeploymentManifestUrl%2A> property.</span></span>  
  
 <span data-ttu-id="949ea-108">Visual Studio 2010 Tools for Office 运行<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>时中有两个不同版本的类。</span><span class="sxs-lookup"><span data-stu-id="949ea-108">There are two different versions of the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> class in the Visual Studio 2010 Tools for Office Runtime.</span></span> <span data-ttu-id="949ea-109">应使用的版本取决于要在其中使用类的应用程序的目标 .NET Framework:</span><span class="sxs-lookup"><span data-stu-id="949ea-109">The version you should use depends on the target .NET Framework of the application in which you want to use the class:</span></span>  
  
-   <span data-ttu-id="949ea-110">对于以[!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument?displayProperty=fullName>或为目标的应用程序,请使用VisualStudio程序集中的类。[!INCLUDE[net_v45](~/includes/net-v45-md.md)]</span><span class="sxs-lookup"><span data-stu-id="949ea-110">For applications that target the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)], use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument?displayProperty=fullName> class in the Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll assembly.</span></span>  
  
-   <span data-ttu-id="949ea-111">对于目标为 .NET Framework 3.5 的应用程序, 请`Microsoft.VisualStudio.Tools.Applications.ServerDocument`使用 ServerDocument 程序集中的类。 VisualStudio。</span><span class="sxs-lookup"><span data-stu-id="949ea-111">For applications that target the .NET Framework 3.5, use the `Microsoft.VisualStudio.Tools.Applications.ServerDocument` class in the Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll assembly.</span></span>  
  
 <span data-ttu-id="949ea-112">有关详细信息，请参阅 [Managing Documents on a Server by Using the ServerDocument Class](/visualstudio/vsto/managing-documents-on-a-server-by-using-the-serverdocument-class)。</span><span class="sxs-lookup"><span data-stu-id="949ea-112">For more information, see [Managing Documents on a Server by Using the ServerDocument Class](/visualstudio/vsto/managing-documents-on-a-server-by-using-the-serverdocument-class).</span></span>  
  
## <a name="choosing-which-constructor-to-use"></a><span data-ttu-id="949ea-113">选择要使用的构造函数</span><span class="sxs-lookup"><span data-stu-id="949ea-113">Choosing Which Constructor to Use</span></span>  
 <span data-ttu-id="949ea-114">若要使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>类访问文档中的缓存数据或部署清单 URL, 必须<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>创建对象。</span><span class="sxs-lookup"><span data-stu-id="949ea-114">To use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> class to access the cached data or the deployment manifest URL in a document, you must create a <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> object.</span></span>  
  
 <span data-ttu-id="949ea-115">有两组<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>构造函数:</span><span class="sxs-lookup"><span data-stu-id="949ea-115">There are two sets of <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> constructors:</span></span>  
  
-   <span data-ttu-id="949ea-116">可用于访问已在内存中打开的文档的集合。</span><span class="sxs-lookup"><span data-stu-id="949ea-116">A set that you can use to access a document that has already been opened in memory.</span></span>  
  
-   <span data-ttu-id="949ea-117">可用来访问磁盘上的文档的集合。</span><span class="sxs-lookup"><span data-stu-id="949ea-117">A set that you can use to access a document that is on disk.</span></span>  
  
### <a name="accessing-a-document-in-memory"></a><span data-ttu-id="949ea-118">访问内存中的文档</span><span class="sxs-lookup"><span data-stu-id="949ea-118">Accessing a Document in Memory</span></span>  
 <span data-ttu-id="949ea-119">若要访问已在内存中打开的文档, 请使用以下构造函数之一:</span><span class="sxs-lookup"><span data-stu-id="949ea-119">To access a document that has already been opened in memory, use one of the following constructors:</span></span>  
  
-   <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.Byte%5B%5D%2CSystem.String%29?displayProperty=fullName>  
  
-   <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.IO.Stream%2CSystem.String%29?displayProperty=fullName>  
  
 <span data-ttu-id="949ea-120">这些构造函数接受一个表示内存中<xref:System.IO.Stream>文档的字节数组或。</span><span class="sxs-lookup"><span data-stu-id="949ea-120">These constructors accept a byte array or a <xref:System.IO.Stream> that represents the document in memory.</span></span> <span data-ttu-id="949ea-121">如果要在文档中修改缓存的数据或应用程序清单, 然后使用 HTTP 协议将其流式传输到目标, 则此方法非常有用。</span><span class="sxs-lookup"><span data-stu-id="949ea-121">This is useful if you want to modify the cached data or application manifest in the document before streaming it to a destination by using the HTTP protocol.</span></span> <span data-ttu-id="949ea-122">若要使用这些构造函数, 文档必须已具有自定义;否则, 这些构造函数将引发<xref:Microsoft.VisualStudio.Tools.Applications.Runtime.CannotLoadManifestException>异常。</span><span class="sxs-lookup"><span data-stu-id="949ea-122">To use these constructors, the document must already have a customization; otherwise, these constructors will throw a <xref:Microsoft.VisualStudio.Tools.Applications.Runtime.CannotLoadManifestException> exception.</span></span>  
  
### <a name="accessing-a-document-on-disk"></a><span data-ttu-id="949ea-123">访问磁盘上的文档</span><span class="sxs-lookup"><span data-stu-id="949ea-123">Accessing a Document on Disk</span></span>  
 <span data-ttu-id="949ea-124">若要访问磁盘上的文档, 请使用以下构造函数之一:</span><span class="sxs-lookup"><span data-stu-id="949ea-124">To access a document that is on disk, use one of the following constructors:</span></span>  
  
-   <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%29?displayProperty=fullName>  
  
-   <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%2CSystem.IO.FileAccess%29?displayProperty=fullName>  
  
 <span data-ttu-id="949ea-125">这些构造函数接受要打开的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="949ea-125">These constructors accept the full path of the document that you want to open.</span></span> <span data-ttu-id="949ea-126">默认情况下, 文档以读/写访问权限打开。</span><span class="sxs-lookup"><span data-stu-id="949ea-126">By default, the document is opened with read/write access.</span></span> <span data-ttu-id="949ea-127">如果要使用只读或只写访问权限打开文档, 请使用带有<xref:System.IO.FileAccess>参数的构造函数。</span><span class="sxs-lookup"><span data-stu-id="949ea-127">If you want to open the document with read-only or write-only access, use the constructor that has a <xref:System.IO.FileAccess> parameter.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-128">下面的代码示例创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>的, 它将加载指定的文档, 然后显示附加到文档的自定义项的部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="949ea-128">The following code example creates a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> that loads a specified document and then displays the URL of the deployment manifest for the customization that is attached to the document.</span></span>  
  
 <span data-ttu-id="949ea-129">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-129">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-130">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-130">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-131">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-131">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-132">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-132">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-133">or</span><span class="sxs-lookup"><span data-stu-id="949ea-133">or</span></span>  
  
    -   <span data-ttu-id="949ea-134">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-134">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-135">`Imports`(对于 Visual Basic) 或`using` (对于C#) <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>代码文件顶部<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>的和命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-135">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#1](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#1)]
 [!code-vb[Trin_ServerDocument#1](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#1)]  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ServerDocument (string documentPath);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string documentPath) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.#ctor(System.String)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="949ea-136">要加载的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="949ea-136">The full path of the document to be loaded.</span></span></param>
        <summary><span data-ttu-id="949ea-137">使用要加载的文档的完整路径，初始化 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="949ea-137">Initializes a new instance of the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> class using the full path of the document to be loaded.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-138">使用此构造函数可以访问磁盘上的文档中的缓存数据或部署清单信息。</span><span class="sxs-lookup"><span data-stu-id="949ea-138">Use this constructor to access the cached data or deployment manifest information in a document that is on disk.</span></span> <span data-ttu-id="949ea-139">使用此构造函数时, 将以读/写访问权限打开指定的文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-139">When you use this constructor, the specified document is opened with read/write access.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-140">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%29>构造函数来创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>的, 以便加载指定的文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-140">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%29> constructor to create a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> that loads a specified document.</span></span> <span data-ttu-id="949ea-141">然后, 该示例显示附加到文档的自定义项的部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="949ea-141">The example then displays the URL of the deployment manifest for the customization that is attached to the document.</span></span>  
  
 <span data-ttu-id="949ea-142">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-142">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-143">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-143">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-144">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-144">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-145">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-145">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-146">or</span><span class="sxs-lookup"><span data-stu-id="949ea-146">or</span></span>  
  
    -   <span data-ttu-id="949ea-147">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-147">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-148">`Imports`(对于 Visual Basic) 或`using` (对于C#) <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>代码文件顶部<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>的和命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-148">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#1](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#1)]
 [!code-vb[Trin_ServerDocument#1](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="949ea-149"><paramref name="documentPath" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="949ea-149">The <paramref name="documentPath" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="949ea-150"><paramref name="documentPath" /> 指定的文件不存在。</span><span class="sxs-lookup"><span data-stu-id="949ea-150">The file specified by <paramref name="documentPath" /> does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="949ea-151"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="949ea-151">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="949ea-152">[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 不支持 <paramref name="documentPath" /> 指定的文件的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="949ea-152">The file specified by <paramref name="documentPath" /> has a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ServerDocument (byte[] bytes, string fileType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(unsigned int8[] bytes, string fileType) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.#ctor(System.Byte[],System.String)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="bytes" Type="System.Byte[]" />
        <Parameter Name="fileType" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="bytes"><span data-ttu-id="949ea-153">一个表示要加载的文档的字节数组。</span><span class="sxs-lookup"><span data-stu-id="949ea-153">A byte array that represents the document to be loaded.</span></span></param>
        <param name="fileType"><span data-ttu-id="949ea-154">文档的文件扩展名，存储在 <c>bytes</c> 参数中，前面有一个句点 (.)，例如“.xlsx”或“.docx”。</span><span class="sxs-lookup"><span data-stu-id="949ea-154">The file name extension of the document that is stored in the <c>bytes</c> parameter, preceded by a period (.)—for example, ".xlsx" or ".docx".</span></span></param>
        <summary><span data-ttu-id="949ea-155">使用表示要加载的文档的字节数组和该文档的文件扩展名，初始化 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="949ea-155">Initializes a new instance of the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> class using a byte array that represents the document to be loaded and the file name extension of the document.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-156">使用此构造函数可以访问已在内存中的文档中的缓存数据或部署清单信息。</span><span class="sxs-lookup"><span data-stu-id="949ea-156">Use this constructor to access the cached data or deployment manifest information in a document that is already in memory.</span></span> <span data-ttu-id="949ea-157">使用此构造函数时, 将以读/写访问权限打开文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-157">When you use this constructor, the document is opened with read/write access.</span></span>  
  
 <span data-ttu-id="949ea-158">`fileType`参数仅用于确定存储在字节数组中的文档的类型。</span><span class="sxs-lookup"><span data-stu-id="949ea-158">The `fileType` parameter is used only to determine the type of document that is stored in the byte array.</span></span> <span data-ttu-id="949ea-159">的值`fileType`映射到文档级自定义项支持的文件类型之一。</span><span class="sxs-lookup"><span data-stu-id="949ea-159">The value of `fileType` is mapped to one of the file types that are supported for document-level customizations.</span></span> <span data-ttu-id="949ea-160">不会尝试打开该文件。</span><span class="sxs-lookup"><span data-stu-id="949ea-160">No attempt is made to open the file.</span></span> <span data-ttu-id="949ea-161">您可以选择传递完整的文件名 (例如 "Workbook1"), 但如果这样做, 则只使用文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="949ea-161">You can optionally pass in a complete file name (for example, "Workbook1.xlsx"), but if you do this, only the file name extension is used.</span></span> <span data-ttu-id="949ea-162">有关支持的文件类型的详细信息, 请参阅[文档级自定义项的体系结构](/visualstudio/vsto/architecture-of-document-level-customizations)。</span><span class="sxs-lookup"><span data-stu-id="949ea-162">For more information about the supported file types, see [Architecture of Document-Level Customizations](/visualstudio/vsto/architecture-of-document-level-customizations).</span></span>  
  
 <span data-ttu-id="949ea-163">若要在调用此构造函数后访问文档的字节数组, 请使用 [ServerDocument 构造函数\<(byte x: ServerDocument% 2a > 属性。</span><span class="sxs-lookup"><span data-stu-id="949ea-163">To access the byte array for the document after calling this constructor, use the [ServerDocument Constructor (Byte\<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-164">下面的代码示例使用 [ServerDocument 构造函数 (Byte\<x: ServerDocument% 23ctor% 28system.object% 2csystem.string% ServerDocument% 5d%% 29 > 构造函数来创建新的 [构造函数 (\<byte x: ServerDocument >, 其中包含扩展名为 .xlsx 的 Excel 工作簿的字节数组。</span><span class="sxs-lookup"><span data-stu-id="949ea-164">The following code example uses the [ServerDocument Constructor (Byte\<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.Byte%5B%5D%2CSystem.String%29> constructor to create a new [ServerDocument Constructor (Byte\<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> from a byte array that contains an Excel workbook with the .xlsx file name extension.</span></span> <span data-ttu-id="949ea-165">然后, 该示例使用 [ServerDocument 构造函数 (\<Byte x: ServerDocument% 2a > 属性来显示文档中的字节数。</span><span class="sxs-lookup"><span data-stu-id="949ea-165">The example then uses the [ServerDocument Constructor (Byte\<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A> property to display the number of bytes in the document.</span></span>  
  
 <span data-ttu-id="949ea-166">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-166">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-167">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-167">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-168">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-168">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-169">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-169">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-170">or</span><span class="sxs-lookup"><span data-stu-id="949ea-170">or</span></span>  
  
    -   <span data-ttu-id="949ea-171">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-171">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-172">`Imports`(对于 Visual Basic) 或`using` (for C#) 语句 (适用于 [ServerDocument 构造\<函数 (byte x: VisualStudio？ displayProperty = fullName > 和 [ServerDocument 构造函数 (字节)\<x: VisualStudio？ displayProperty = fullName > 你的代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-172">`Imports` (for Visual Basic) or `using` (for C#) statements for [ServerDocument Constructor (Byte\<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and [ServerDocument Constructor (Byte\<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#2](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#2)]
 [!code-vb[Trin_ServerDocument#2](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="949ea-173"><paramref name="bytes" /> 参数为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="949ea-173">The <paramref name="bytes" /> parameter is <see langword="null" /> or empty.</span></span>  
  
<span data-ttu-id="949ea-174">或</span><span class="sxs-lookup"><span data-stu-id="949ea-174">-or-</span></span> 
<span data-ttu-id="949ea-175"><paramref name="fileType" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="949ea-175">The <paramref name="fileType" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="949ea-176">[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 不支持 <paramref name="fileType" /> 参数指定的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="949ea-176">The <paramref name="fileType" /> parameter specifies a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="949ea-177"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="949ea-177">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ServerDocument (System.IO.Stream stream, string fileType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.IO.Stream stream, string fileType) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.#ctor(System.IO.Stream,System.String)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="stream" Type="System.IO.Stream" />
        <Parameter Name="fileType" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="stream"><span data-ttu-id="949ea-178">表示要加载的文档的流。</span><span class="sxs-lookup"><span data-stu-id="949ea-178">A stream that represents the document to be loaded.</span></span></param>
        <param name="fileType"><span data-ttu-id="949ea-179">文档的文件扩展名，存储在 <c>bytes</c> 参数中，前面有一个句点 (.)，例如“.xlsx”或“.docx”。</span><span class="sxs-lookup"><span data-stu-id="949ea-179">The file name extension of the document that is stored in the <c>bytes</c> parameter, preceded by a period (.)—for example, ".xlsx" or ".docx".</span></span></param>
        <summary><span data-ttu-id="949ea-180">使用表示要加载的文档的流和该文档的文件扩展名，初始化 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="949ea-180">Initializes a new instance of the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> class using a stream that represents the document to be loaded and the file name extension of the document.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-181">使用此构造函数可以访问已在内存中的文档中的缓存数据或部署清单信息。</span><span class="sxs-lookup"><span data-stu-id="949ea-181">Use this constructor to access the cached data or deployment manifest information in a document that is already in memory.</span></span> <span data-ttu-id="949ea-182">使用此构造函数时, 将以读/写访问权限打开文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-182">When you use this constructor, the document is opened with read/write access.</span></span>  
  
 <span data-ttu-id="949ea-183">`fileType`参数仅用于确定存储在字节数组中的文档的类型。</span><span class="sxs-lookup"><span data-stu-id="949ea-183">The `fileType` parameter is used only to determine the type of document that is stored in the byte array.</span></span> <span data-ttu-id="949ea-184">的值`fileType`映射到文档级自定义项支持的文件类型之一。</span><span class="sxs-lookup"><span data-stu-id="949ea-184">The value of `fileType` is mapped to one of the file types that are supported for document-level customizations.</span></span> <span data-ttu-id="949ea-185">不会尝试打开该文件。</span><span class="sxs-lookup"><span data-stu-id="949ea-185">No attempt is made to open the file.</span></span> <span data-ttu-id="949ea-186">您可以选择传递完整的文件名 (例如 "Workbook1"), 但如果这样做, 则只使用文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="949ea-186">You can optionally pass in a complete file name (for example, "Workbook1.xlsx"), but if you do this, only the file name extension is used.</span></span> <span data-ttu-id="949ea-187">有关支持的文件类型的详细信息, 请参阅[文档级自定义项的体系结构](/visualstudio/vsto/architecture-of-document-level-customizations)。</span><span class="sxs-lookup"><span data-stu-id="949ea-187">For more information about the supported file types, see [Architecture of Document-Level Customizations](/visualstudio/vsto/architecture-of-document-level-customizations).</span></span>  
  
 <span data-ttu-id="949ea-188">若要在调用此构造函数后访问文档的字节数组, 请<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A>使用属性。</span><span class="sxs-lookup"><span data-stu-id="949ea-188">To access the byte array for the document after calling this constructor, use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-189">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.IO.Stream%2CSystem.String%29>构造函数从中<xref:System.IO.FileStream>创建一个<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>新的, 其中包含扩展名为 .xlsx 的 Excel 工作簿。</span><span class="sxs-lookup"><span data-stu-id="949ea-189">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.IO.Stream%2CSystem.String%29> constructor to create a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> from a <xref:System.IO.FileStream> that contains an Excel workbook with the .xlsx file name extension.</span></span> <span data-ttu-id="949ea-190">然后, 该代码显示附加到文档的自定义项的部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="949ea-190">The code then displays the URL of the deployment manifest for the customization that is attached to the document.</span></span>  
  
 <span data-ttu-id="949ea-191">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-191">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-192">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-192">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-193">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-193">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-194">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-194">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-195">or</span><span class="sxs-lookup"><span data-stu-id="949ea-195">or</span></span>  
  
    -   <span data-ttu-id="949ea-196">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-196">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-197">`Imports`(对于 Visual Basic) 或`using` (对于C#) <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>代码文件顶部<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>的和命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-197">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#3](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#3)]
 [!code-vb[Trin_ServerDocument#3](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="949ea-198"><paramref name="stream" /> 参数为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="949ea-198">The <paramref name="stream" /> parameter is <see langword="null" /> or empty.</span></span>  
  
<span data-ttu-id="949ea-199">或</span><span class="sxs-lookup"><span data-stu-id="949ea-199">-or-</span></span> 
<span data-ttu-id="949ea-200"><paramref name="fileType" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="949ea-200">The <paramref name="fileType" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="949ea-201"><paramref name="stream" /> 参数的长度为零或其当前位置位于流的末尾。</span><span class="sxs-lookup"><span data-stu-id="949ea-201">The <paramref name="stream" /> parameter has zero length or its current position is at the stream's end.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="949ea-202">[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 不支持 <paramref name="fileType" /> 参数指定的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="949ea-202">The <paramref name="fileType" /> parameter specifies a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="949ea-203"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="949ea-203">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ServerDocument (string documentPath, System.IO.FileAccess access);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string documentPath, valuetype System.IO.FileAccess access) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.#ctor(System.String,System.IO.FileAccess)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
        <Parameter Name="access" Type="System.IO.FileAccess" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="949ea-204">要加载的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="949ea-204">The full path of the document to be loaded.</span></span></param>
        <param name="access"><span data-ttu-id="949ea-205">一个指示对文档的文件访问权限的值。</span><span class="sxs-lookup"><span data-stu-id="949ea-205">A value that indicates the file access for the document.</span></span></param>
        <summary><span data-ttu-id="949ea-206">使用要加载的文档的完整路径和一个指示对该文档的文件访问权限的值，初始化 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="949ea-206">Initializes a new instance of the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> class using the full path of the document to be loaded and a value that indicates the file access for the document.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-207">如果要使用只读或只写访问权限打开文档, 请使用此构造函数访问磁盘上的文档中的缓存数据或部署清单信息。</span><span class="sxs-lookup"><span data-stu-id="949ea-207">Use this constructor to access the cached data or deployment manifest information in a document that is on disk if you want to open the document with read-only or write-only access.</span></span> <span data-ttu-id="949ea-208">默认情况下, 其他<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>构造函数以读/写访问权限打开文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-208">By default, the other <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> constructors open the document with read/write access.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-209">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%2CSystem.IO.FileAccess%29>构造函数来创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>的, 它将加载具有只读访问权限的指定文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-209">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%2CSystem.IO.FileAccess%29> constructor to create a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> that loads a specified document with read-only access.</span></span> <span data-ttu-id="949ea-210">然后, 该代码显示附加到文档的自定义项的部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="949ea-210">The code then displays the URL of the deployment manifest for the customization that is attached to the document.</span></span>  
  
 <span data-ttu-id="949ea-211">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-211">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-212">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-212">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-213">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-213">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-214">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-214">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-215">or</span><span class="sxs-lookup"><span data-stu-id="949ea-215">or</span></span>  
  
    -   <span data-ttu-id="949ea-216">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-216">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-217">`Imports`(对于 Visual Basic) 或`using` (对于C#) <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>代码文件顶部<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>的和命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-217">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#4](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#4)]
 [!code-vb[Trin_ServerDocument#4](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="949ea-218"><paramref name="documentPath" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="949ea-218">The <paramref name="documentPath" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="949ea-219"><paramref name="access" /> 的值是 <c>System.IO.FileAccess.Write</c>。</span><span class="sxs-lookup"><span data-stu-id="949ea-219">The value of <paramref name="access" /> is <c>System.IO.FileAccess.Write</c>.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="949ea-220"><paramref name="documentPath" /> 指定的文件不存在。</span><span class="sxs-lookup"><span data-stu-id="949ea-220">The file specified by <paramref name="documentPath" /> does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentNotCustomizedException"><span data-ttu-id="949ea-221"><paramref name="documentPath" /> 参数指定的文件不具有自定义，并且 <paramref name="access" /> 的值为 <c>System.IO.FileAccess.Read</c>。</span><span class="sxs-lookup"><span data-stu-id="949ea-221">The file specified by the <paramref name="documentPath" /> parameter does not have a customization, and the value of <paramref name="access" /> is <c>System.IO.FileAccess.Read</c>.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="949ea-222"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="949ea-222">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="949ea-223">[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 不支持 <paramref name="documentPath" /> 指定的文件的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="949ea-223">The file specified by <paramref name="documentPath" /> has a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="AddCustomization">
      <MemberSignature Language="C#" Value="public static void AddCustomization (string documentPath, Uri deploymentManifestUrl);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void AddCustomization(string documentPath, class System.Uri deploymentManifestUrl) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization(System.String,System.Uri)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
        <Parameter Name="deploymentManifestUrl" Type="System.Uri" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="949ea-224">要向其附加自定义的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="949ea-224">The full path of the document to which you want to attach a customization.</span></span></param>
        <param name="deploymentManifestUrl"><span data-ttu-id="949ea-225">解决方案部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="949ea-225">The URL of the deployment manifest for the solution.</span></span></param>
        <summary><span data-ttu-id="949ea-226">使用指定的程序集名称和部署清单，将自定义项附加到指定文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-226">Attaches a customization to the specified document by using the specified assembly name and deployment manifest.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-227">方法通过向文档中`_AssemblyName`添加和`_AssemblyLocation`自定义文档属性, 将指定的自定义与文档相关联。 <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A></span><span class="sxs-lookup"><span data-stu-id="949ea-227">The <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method associates the specified customization with the document by adding the `_AssemblyName` and `_AssemblyLocation` custom document properties to the document.</span></span> <span data-ttu-id="949ea-228">这些属性标识文档具有自定义项, 并指定部署清单的位置。</span><span class="sxs-lookup"><span data-stu-id="949ea-228">These properties identify that the document has a customization and specify the location of the deployment manifest.</span></span> <span data-ttu-id="949ea-229">成功调用此方法后, 当用户下一次打开指定的文档时, 运行时将尝试安装 Office 解决方案。</span><span class="sxs-lookup"><span data-stu-id="949ea-229">After this method is successfully called, the next time a user opens the specified document, the runtime will attempt to install the Office solution.</span></span> <span data-ttu-id="949ea-230">有关自定义文档属性的详细信息, 请参阅[自定义文档属性概述](/visualstudio/vsto/custom-document-properties-overview)。</span><span class="sxs-lookup"><span data-stu-id="949ea-230">For more information about the custom document properties, see [Custom Document Properties Overview](/visualstudio/vsto/custom-document-properties-overview).</span></span>  
  
 <span data-ttu-id="949ea-231">如果指定的文档不包含自定义项希望文档具有的控件, 则该<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>方法将会成功, 但当用户打开文档时, 该程序集将无法加载。</span><span class="sxs-lookup"><span data-stu-id="949ea-231">If the specified document does not contain a control that the customization expects the document to have, the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method will succeed, but the assembly will fail to load when the user opens the document.</span></span>  
  
 <span data-ttu-id="949ea-232">`fileType`参数必须指定具有文档级自定义项支持的文件扩展名的文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-232">The `fileType` parameter must specify a document that has a file name extension that is supported for document-level customizations.</span></span> <span data-ttu-id="949ea-233">不能将自定义附加到以 word xml 文档 (\* xml) 或 word 2003 XML 文档 (\*xml) 文件格式保存的文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-233">You cannot attach a customization to a document that is saved in the Word XML Document (\*xml) or Word 2003 XML Document (\*xml) file formats.</span></span> <span data-ttu-id="949ea-234">有关支持的文件类型的详细信息, 请参阅[文档级自定义项的体系结构](/visualstudio/vsto/architecture-of-document-level-customizations)。</span><span class="sxs-lookup"><span data-stu-id="949ea-234">For more information about the supported file types, see [Architecture of Document-Level Customizations](/visualstudio/vsto/architecture-of-document-level-customizations).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-235">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>方法将自定义项附加到指定文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-235">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method to attach a customization to the specified document.</span></span>  
  
 <span data-ttu-id="949ea-236">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-236">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-237">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-237">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-238">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-238">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-239">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-239">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-240">or</span><span class="sxs-lookup"><span data-stu-id="949ea-240">or</span></span>  
  
    -   <span data-ttu-id="949ea-241">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-241">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-242">`Imports`(对于 Visual Basic) 或`using` (对于C#) <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>代码文件顶部<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>的和命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-242">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#6](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#6)]
 [!code-vb[Trin_ServerDocument#6](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#6)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="949ea-243"><paramref name="documentPath" /> 或 <paramref name="deploymentManifestUrl" /> 为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="949ea-243"><paramref name="documentPath" /> or <paramref name="deploymentManifestUrl" /> is <see langword="null" /> or empty.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="949ea-244"><paramref name="deploymentManifestUrl" /> 未指定绝对 URL。</span><span class="sxs-lookup"><span data-stu-id="949ea-244"><paramref name="deploymentManifestUrl" /> does not specify an absolute URL.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="949ea-245"><paramref name="documentPath" /> 或 <paramref name="deploymentManifestUrl" /> 表示一个不存在的文件。</span><span class="sxs-lookup"><span data-stu-id="949ea-245"><paramref name="documentPath" /> or <paramref name="deploymentManifestUrl" /> refers to a file that does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentAlreadyCustomizedException"><span data-ttu-id="949ea-246"><paramref name="documentPath" /> 指定的文档已具有自定义。</span><span class="sxs-lookup"><span data-stu-id="949ea-246">The document specified by <paramref name="documentPath" /> already has a customization.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.InvalidManifestException"><span data-ttu-id="949ea-247"><paramref name="deploymentManifestUrl" /> 指定的部署清单不是有效的部署清单。</span><span class="sxs-lookup"><span data-stu-id="949ea-247">The deployment manifest specified by <paramref name="deploymentManifestUrl" /> is not a valid deployment manifest.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentNotCustomizedException"><span data-ttu-id="949ea-248"><paramref name="documentPath" /> 指定的文档已损坏，或具有受限权限。</span><span class="sxs-lookup"><span data-stu-id="949ea-248">The document specified by <paramref name="documentPath" /> is corrupt, or has restricted permissions.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="949ea-249"><paramref name="documentPath" /> 指定的文档具有不受 [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 支持的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="949ea-249">The document specified by <paramref name="documentPath" /> has a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="AddCustomization">
      <MemberSignature Language="C#" Value="public static void AddCustomization (string documentPath, string assemblyName, Guid solutionId, Uri deploymentManifestUrl);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void AddCustomization(string documentPath, string assemblyName, valuetype System.Guid solutionId, class System.Uri deploymentManifestUrl) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization(System.String,System.String,System.Guid,System.Uri)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
        <Parameter Name="assemblyName" Type="System.String" />
        <Parameter Name="solutionId" Type="System.Guid" />
        <Parameter Name="deploymentManifestUrl" Type="System.Uri" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="949ea-250">要向其附加自定义的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="949ea-250">The full path of the document to which you want to attach a customization.</span></span></param>
        <param name="assemblyName"><span data-ttu-id="949ea-251">用于自定义的程序集的完整路径。</span><span class="sxs-lookup"><span data-stu-id="949ea-251">The full path of the assembly for the customization.</span></span> <span data-ttu-id="949ea-252">该路径必须位于本地文件系统或 UNC 共享上；不能指定 HTTP 位置。</span><span class="sxs-lookup"><span data-stu-id="949ea-252">The path must be on the local file system or a UNC share; you cannot specify an HTTP location.</span></span></param>
        <param name="solutionId"><span data-ttu-id="949ea-253">一个 GUID，[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 可用其标识解决方案。</span><span class="sxs-lookup"><span data-stu-id="949ea-253">A GUID that the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] uses to identify the solution.</span></span></param>
        <param name="deploymentManifestUrl"><span data-ttu-id="949ea-254">解决方案部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="949ea-254">The URL of the deployment manifest for the solution.</span></span></param>
        <summary><span data-ttu-id="949ea-255">通过使用指定文档、程序集名称、解决方案 ID 和部署清单，将自定义附加到指定文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-255">Attaches a customization to the specified document by using the specified document, assembly name, solution ID, and deployment manifest.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-256">方法通过向文档中`_AssemblyName`添加和`_AssemblyLocation`自定义文档属性, 将指定的自定义与文档相关联。 <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A></span><span class="sxs-lookup"><span data-stu-id="949ea-256">The <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method associates the specified customization with the document by adding the `_AssemblyName` and `_AssemblyLocation` custom document properties to the document.</span></span> <span data-ttu-id="949ea-257">这些属性标识文档具有自定义项, 并指定部署清单的位置。</span><span class="sxs-lookup"><span data-stu-id="949ea-257">These properties identify that the document has a customization and specify the location of the deployment manifest.</span></span> <span data-ttu-id="949ea-258">成功调用此方法后, 当用户下一次打开指定的文档时, 运行时将尝试安装 Office 解决方案。</span><span class="sxs-lookup"><span data-stu-id="949ea-258">After this method is successfully called, the next time a user opens the specified document, the runtime attempts to install the Office solution.</span></span> <span data-ttu-id="949ea-259">有关自定义文档属性的详细信息, 请参阅[自定义文档属性概述](/visualstudio/vsto/custom-document-properties-overview)。</span><span class="sxs-lookup"><span data-stu-id="949ea-259">For more information about the custom document properties, see [Custom Document Properties Overview](/visualstudio/vsto/custom-document-properties-overview).</span></span>  
  
 <span data-ttu-id="949ea-260">传递给`solutionID`参数的 GUID 是在附加到文档的解决方案的应用程序清单中指定的。</span><span class="sxs-lookup"><span data-stu-id="949ea-260">The GUID that you pass to the `solutionID` parameter is specified in the application manifest of the solution that you are attaching to the document.</span></span> <span data-ttu-id="949ea-261">必须传递应用程序清单中的`solutionId` `vstov4:document`元素的属性中指定的同一 GUID。</span><span class="sxs-lookup"><span data-stu-id="949ea-261">You must pass the same GUID that is specified in the `solutionId` attribute of the `vstov4:document` element in the application manifest.</span></span> <span data-ttu-id="949ea-262">有关详细信息, 请参阅[Office 解决方案中的应用程序和部署清单](/visualstudio/vsto/application-and-deployment-manifests-in-office-solutions)和[ \&lt; 文档\&g t;元素](/visualstudio/vsto/document-element-office-development-in-visual-studio)。</span><span class="sxs-lookup"><span data-stu-id="949ea-262">For more information, see [Application and Deployment Manifests in Office Solutions](/visualstudio/vsto/application-and-deployment-manifests-in-office-solutions) and [\&lt;document\&gt; Element](/visualstudio/vsto/document-element-office-development-in-visual-studio).</span></span>  
  
 <span data-ttu-id="949ea-263">如果要从发布位置附加自定义项, 请确保在`assemblyName`参数中为程序集指定了正确的文件名。</span><span class="sxs-lookup"><span data-stu-id="949ea-263">If you are attaching a customization from a publish location, make sure that you specify the correct file name for the assembly in the `assemblyName` parameter.</span></span> <span data-ttu-id="949ea-264">发布 Office 解决方案时, 复制到发布文件夹的程序集具有 .deploy 文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="949ea-264">When you publish an Office solution, the assembly that is copied to the publish folder has the .deploy file name extension.</span></span> <span data-ttu-id="949ea-265">例如, 如果程序集名称为 Worddocument1.docx, 则发布文件夹中的程序集的文件名为 Worddocument1.docx。</span><span class="sxs-lookup"><span data-stu-id="949ea-265">For example, if the assembly name is WordDocument1.dll, the file name of the assembly in the publish folder is WordDocument1.dll.deploy.</span></span> <span data-ttu-id="949ea-266">有关详细信息, 请参阅[使用 ClickOnce 部署 Office 解决方案](/visualstudio/vsto/deploying-an-office-solution-by-using-clickonce)。</span><span class="sxs-lookup"><span data-stu-id="949ea-266">For more information, see [Deploying an Office Solution by Using ClickOnce](/visualstudio/vsto/deploying-an-office-solution-by-using-clickonce).</span></span>  
  
 <span data-ttu-id="949ea-267">如果指定的文档不包含自定义项希望文档具有的控件, 则该<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>方法将会成功, 但当用户打开文档时, 该程序集将无法加载。</span><span class="sxs-lookup"><span data-stu-id="949ea-267">If the specified document does not contain a control that the customization expects the document to have, the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method will succeed, but the assembly will fail to load when the user opens the document.</span></span>  
  
 <span data-ttu-id="949ea-268">`fileType`参数必须指定具有文件扩展名的文档, 该文档级自定义项支持的文档级自定义项 Microsoft Office Word 和 Microsoft Office Excel。</span><span class="sxs-lookup"><span data-stu-id="949ea-268">The `fileType` parameter must specify a document that has a file name extension that is supported for document-level customizations for Microsoft Office Word and Microsoft Office Excel.</span></span> <span data-ttu-id="949ea-269">不能将自定义附加到以 word xml 文档 (\* xml) 或 word 2003 XML 文档 (\*xml) 文件格式保存的文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-269">You cannot attach a customization to a document that is saved in the Word XML Document (\*xml) or Word 2003 XML Document (\*xml) file formats.</span></span> <span data-ttu-id="949ea-270">有关支持的文件类型的详细信息, 请参阅[文档级自定义项的体系结构](/visualstudio/vsto/architecture-of-document-level-customizations)。</span><span class="sxs-lookup"><span data-stu-id="949ea-270">For more information about the supported file types, see [Architecture of Document-Level Customizations](/visualstudio/vsto/architecture-of-document-level-customizations).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-271">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>方法将自定义项附加到指定文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-271">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method to attach a customization to the specified document.</span></span>  
  
 <span data-ttu-id="949ea-272">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-272">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-273">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-273">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-274">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-274">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-275">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-275">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-276">or</span><span class="sxs-lookup"><span data-stu-id="949ea-276">or</span></span>  
  
    -   <span data-ttu-id="949ea-277">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-277">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
 [!code-csharp[Trin_ServerDocument#7](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#7)]
 [!code-vb[Trin_ServerDocument#7](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="949ea-278"><paramref name="documentPath" /> 或 <paramref name="assemblyName" /> 为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="949ea-278"><paramref name="documentPath" /> or <paramref name="assemblyName" /> is <see langword="null" /> or empty.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="949ea-279"><paramref name="documentPath" /> 或 <paramref name="assemblyName" /> 表示一个不存在的文件。</span><span class="sxs-lookup"><span data-stu-id="949ea-279"><paramref name="documentPath" /> or <paramref name="assemblyName" /> refers to a file that does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentAlreadyCustomizedException"><span data-ttu-id="949ea-280"><paramref name="documentPath" /> 指定的文档已具有自定义。</span><span class="sxs-lookup"><span data-stu-id="949ea-280">The document specified by <paramref name="documentPath" /> already has a customization.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentNotCustomizedException"><span data-ttu-id="949ea-281"><paramref name="documentPath" /> 指定的文档已损坏，或具有受限权限。</span><span class="sxs-lookup"><span data-stu-id="949ea-281">The document specified by <paramref name="documentPath" /> is corrupt, or has restricted permissions.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="949ea-282"><paramref name="documentPath" /> 指定的文档具有不受 [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 支持的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="949ea-282">The document specified by <paramref name="documentPath" /> has a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="AddCustomization">
      <MemberSignature Language="C#" Value="public static void AddCustomization (string documentPath, string assemblyName, Guid solutionId, Uri deploymentManifestUrl, bool runAsLocal, out string[] nonpublicCachedDataMembers);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void AddCustomization(string documentPath, string assemblyName, valuetype System.Guid solutionId, class System.Uri deploymentManifestUrl, bool runAsLocal, [out] string[]&amp; nonpublicCachedDataMembers) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization(System.String,System.String,System.Guid,System.Uri,System.Boolean,System.String[]@)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
        <Parameter Name="assemblyName" Type="System.String" />
        <Parameter Name="solutionId" Type="System.Guid" />
        <Parameter Name="deploymentManifestUrl" Type="System.Uri" />
        <Parameter Name="runAsLocal" Type="System.Boolean" />
        <Parameter Name="nonpublicCachedDataMembers" Type="System.String[]" RefType="out" />
      </Parameters>
      <Docs>
        <param name="documentPath">To be added.</param>
        <param name="assemblyName">To be added.</param>
        <param name="solutionId">To be added.</param>
        <param name="deploymentManifestUrl">To be added.</param>
        <param name="runAsLocal">To be added.</param>
        <param name="nonpublicCachedDataMembers">To be added.</param>
        <summary>To be added.</summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="CachedData">
      <MemberSignature Language="C#" Value="public Microsoft.VisualStudio.Tools.Applications.CachedData CachedData { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class Microsoft.VisualStudio.Tools.Applications.CachedData CachedData" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.VisualStudio.Tools.Applications.CachedData</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="949ea-283">获取一个 <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedData" /> 对象，表示文档中包含的缓存数据。</span><span class="sxs-lookup"><span data-stu-id="949ea-283">Gets a <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedData" /> object that represents the cached data that is contained in the document.</span></span></summary>
        <value><span data-ttu-id="949ea-284">文档中包含的缓存数据。</span><span class="sxs-lookup"><span data-stu-id="949ea-284">The cached data that is contained in the document.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-285">文档中的缓存数据存储在对象的层次结构中。</span><span class="sxs-lookup"><span data-stu-id="949ea-285">The cached data in a document is stored in a hierarchy of objects.</span></span> <span data-ttu-id="949ea-286">此属性返回的对象是该层次结构中的第一个对象。<xref:Microsoft.VisualStudio.Tools.Applications.CachedData></span><span class="sxs-lookup"><span data-stu-id="949ea-286">The <xref:Microsoft.VisualStudio.Tools.Applications.CachedData> object returned by this property is the first object in that hierarchy.</span></span> <span data-ttu-id="949ea-287">有关详细信息，请参阅 [Accessing Data in Documents on the Server](/visualstudio/vsto/accessing-data-in-documents-on-the-server)。</span><span class="sxs-lookup"><span data-stu-id="949ea-287">For more information, see [Accessing Data in Documents on the Server](/visualstudio/vsto/accessing-data-in-documents-on-the-server).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-288">下面的代码示例创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>的, 然后<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData%2A>使用属性显示数据缓存中的对象的名称。</span><span class="sxs-lookup"><span data-stu-id="949ea-288">The following code example creates a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>, and then uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData%2A> property to display the names of the objects in the data cache.</span></span>  
  
 <span data-ttu-id="949ea-289">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-289">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-290">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-290">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-291">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-291">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-292">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-292">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-293">or</span><span class="sxs-lookup"><span data-stu-id="949ea-293">or</span></span>  
  
    -   <span data-ttu-id="949ea-294">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-294">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-295">`Imports`(对于 Visual Basic) 或`using` (对于C#) <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>代码文件顶部<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>的和命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-295">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#5](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#5)]
 [!code-vb[Trin_ServerDocument#5](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#5)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="949ea-296">关闭 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="949ea-296">Closes the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-297">调用此方法可释放所有资源并关闭<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>。</span><span class="sxs-lookup"><span data-stu-id="949ea-297">Call this method to release all resources and close the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-298">下面的代码示例创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>的, 显示部署清单的 URL, 然后<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close%2A>使用方法关闭<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>。</span><span class="sxs-lookup"><span data-stu-id="949ea-298">The following code example creates a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>, displays the URL of the deployment manifest, and then uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close%2A> method to close the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>.</span></span>  
  
 <span data-ttu-id="949ea-299">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-299">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-300">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-300">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-301">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-301">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-302">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-302">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-303">or</span><span class="sxs-lookup"><span data-stu-id="949ea-303">or</span></span>  
  
    -   <span data-ttu-id="949ea-304">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-304">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-305">`Imports`(对于 Visual Basic) 或`using` (对于C#) <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>代码文件顶部<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>的和命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-305">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#1](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#1)]
 [!code-vb[Trin_ServerDocument#1](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="DeploymentManifestUrl">
      <MemberSignature Language="C#" Value="public Uri DeploymentManifestUrl { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Uri DeploymentManifestUrl" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualStudio.Tools.Applications.ServerDocument.DeploymentManifestUrl" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Uri</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="949ea-306">获取或设置与文档关联的自定义项的部署清单 URL。</span><span class="sxs-lookup"><span data-stu-id="949ea-306">Gets or sets the URL of the deployment manifest for the customization that is associated with the document.</span></span></summary>
        <value><span data-ttu-id="949ea-307">一个 URL，指定与文档关联的自定义项的部署清单的名称和位置。</span><span class="sxs-lookup"><span data-stu-id="949ea-307">A URL that specifies the name and location of the deployment manifest for the customization that is associated with the document.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-308">如果将自定义项的部署清单移到其他位置, 并且希望文档从新位置查找自定义更新, 请将此属性设置为新的 URL。</span><span class="sxs-lookup"><span data-stu-id="949ea-308">Set this property to a new URL if you move the deployment manifest for a customization to a different location, and you want the document to locate customization updates from the new location.</span></span> <span data-ttu-id="949ea-309">如果设置此属性, 则 URL 必须指向已与文档相关联的自定义项的部署清单。</span><span class="sxs-lookup"><span data-stu-id="949ea-309">If you set this property, the URL must point to a deployment manifest for the customization that is already associated with the document.</span></span>  
  
 <span data-ttu-id="949ea-310">不能使用此属性将新的自定义项与文档相关联。</span><span class="sxs-lookup"><span data-stu-id="949ea-310">You cannot use this property to associate a new customization with a document.</span></span> <span data-ttu-id="949ea-311">若要将自定义添加到非自定义文档<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>中, 请使用方法。</span><span class="sxs-lookup"><span data-stu-id="949ea-311">To add a customization to an uncustomized document, use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method.</span></span> <span data-ttu-id="949ea-312">若要将其他自定义添加到自定义文档, 请<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization%2A>首先使用方法移除当前自定义项, 然后<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>使用方法。</span><span class="sxs-lookup"><span data-stu-id="949ea-312">To add a different customization to a customized document, first use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization%2A> method to remove the current customization, and then use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method.</span></span>  
  
## <a name="getting-the-url-in-applications-that-target-the-net-framework-35"></a><span data-ttu-id="949ea-313">在应用程序中获取面向 .NET Framework 3.5 的 URL</span><span class="sxs-lookup"><span data-stu-id="949ea-313">Getting the URL in Applications that Target the .NET Framework 3.5</span></span>  
 <span data-ttu-id="949ea-314">当你在面向`ServerDocument` .NET Framework 3.5 的应用程序中使用 ServerDocument 中的 VisualStudio 程序集时<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.DeploymentManifestUrl%2A> , 属性将仅返回当前的部署清单 URL如果在运行应用程序的计算机上安装了文档级自定义项, 则为。</span><span class="sxs-lookup"><span data-stu-id="949ea-314">When you use the `ServerDocument` class in the Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll assembly in an application that targets the .NET Framework 3.5, the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.DeploymentManifestUrl%2A> property returns the current deployment manifest URL only if the documentation-level customization is installed on the computer where you are running the application.</span></span> <span data-ttu-id="949ea-315">对于其他类型的单元格，此属性返回 `null`。</span><span class="sxs-lookup"><span data-stu-id="949ea-315">Otherwise, this property returns `null`.</span></span>  
  
 <span data-ttu-id="949ea-316">如果需要获取在运行应用程序的计算机上未安装的文档级自定义项的部署清单 URL (例如, 在发布文档级自定义项的服务器上), 请将 .NET Framework 4 定位到该应用程序将引用 VisualStudio 程序集, 并使用该程序集中的`ServerDocument`类。</span><span class="sxs-lookup"><span data-stu-id="949ea-316">If you need to get the deployment manifest URL of a document-level customization that is not installed on the computer where you are running the application (for example, on a server where a document-level customization is published), target the .NET Framework 4 in the application, reference the Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll assembly, and use the `ServerDocument` class in that assembly.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-317">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%29>构造函数来创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>的, 以便加载指定的文档。</span><span class="sxs-lookup"><span data-stu-id="949ea-317">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%29> constructor to create a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> that loads a specified document.</span></span> <span data-ttu-id="949ea-318">然后, 该示例显示附加到文档的自定义项的部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="949ea-318">The example then displays the URL of the deployment manifest for the customization that is attached to the document.</span></span>  
  
 <span data-ttu-id="949ea-319">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-319">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-320">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-320">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-321">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-321">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-322">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-322">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-323">or</span><span class="sxs-lookup"><span data-stu-id="949ea-323">or</span></span>  
  
    -   <span data-ttu-id="949ea-324">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-324">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-325">`Imports`(对于 Visual Basic) 或`using` (对于C#) <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>代码文件顶部<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>的和命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-325">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#1](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#1)]
 [!code-vb[Trin_ServerDocument#1](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Document">
      <MemberSignature Language="C#" Value="public byte[] Document { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance unsigned int8[] Document" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Byte[]</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="949ea-326">获取加载到 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 中的内存中文档的字节数组。</span><span class="sxs-lookup"><span data-stu-id="949ea-326">Gets the byte array of an in-memory document that is loaded into the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" />.</span></span></summary>
        <value><span data-ttu-id="949ea-327">加载到 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 中的内存中文档的字节数组。</span><span class="sxs-lookup"><span data-stu-id="949ea-327">The byte array of an in-memory document that is loaded into the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-328">如果<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>是<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.IO.Stream%2CSystem.String%29> <xref:System.IO.Stream>使用具有字节数组参数的构造函数创建的,或者具有参数的构造函数,则此属性返回填充的字节数组。<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.Byte%5B%5D%2CSystem.String%29></span><span class="sxs-lookup"><span data-stu-id="949ea-328">This property returns a filled byte array if the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> was created by using the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.Byte%5B%5D%2CSystem.String%29> constructor that has a byte array parameter, or the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.IO.Stream%2CSystem.String%29> constructor that has a <xref:System.IO.Stream> parameter.</span></span> <span data-ttu-id="949ea-329">否则, 此属性返回一个空字节数组。</span><span class="sxs-lookup"><span data-stu-id="949ea-329">Otherwise, this property returns an empty byte array.</span></span>  
  
 <span data-ttu-id="949ea-330">使用此属性, 可以对文档进行更改并将其发送到客户端, 而无需将文档写入磁盘。</span><span class="sxs-lookup"><span data-stu-id="949ea-330">Using this property enables you to make changes to a document and send it to a client without writing the document to disk.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-331">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.Byte%5B%5D%2CSystem.String%29>构造函数从包含扩展名为 .xlsx 的 Excel 工作簿的字节数组创建新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>的。</span><span class="sxs-lookup"><span data-stu-id="949ea-331">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.Byte%5B%5D%2CSystem.String%29> constructor to create a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> from a byte array that contains an Excel workbook with the .xlsx file name extension.</span></span> <span data-ttu-id="949ea-332">然后, 该示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A>属性显示文档中的字节数。</span><span class="sxs-lookup"><span data-stu-id="949ea-332">The example then uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A> property to display the number of bytes in the document.</span></span>  
  
 <span data-ttu-id="949ea-333">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-333">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-334">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-334">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-335">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-335">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-336">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-336">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-337">or</span><span class="sxs-lookup"><span data-stu-id="949ea-337">or</span></span>  
  
    -   <span data-ttu-id="949ea-338">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-338">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-339">`Imports`(对于 Visual Basic) 或`using` (对于C#) <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>代码文件顶部<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>的和命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-339">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#2](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#2)]
 [!code-vb[Trin_ServerDocument#2](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentClosedException"><span data-ttu-id="949ea-340">文档已关闭。</span><span class="sxs-lookup"><span data-stu-id="949ea-340">The document has been closed.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Finalize">
      <MemberSignature Language="C#" Value="~ServerDocument ();" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Finalize() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Finalize" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>To be added.</summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="GetCustomizationVersion">
      <MemberSignature Language="C#" Value="public static int GetCustomizationVersion (string documentPath);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 GetCustomizationVersion(string documentPath) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion(System.String)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="949ea-341">要检查的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="949ea-341">The full path of the document that you want to check.</span></span></param>
        <summary><span data-ttu-id="949ea-342">返回用于创建与指定文档相关联的自定义项的 [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 的版本。</span><span class="sxs-lookup"><span data-stu-id="949ea-342">Returns the version of the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] that was used to create the customization that is associated with the specified document.</span></span></summary>
        <returns><span data-ttu-id="949ea-343">一个编号，指定用于创建关联的自定义项的 [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 版本。</span><span class="sxs-lookup"><span data-stu-id="949ea-343">A number that specifies the version of the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] that was used to create the associated customization.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-344">不同版本的 Visual Studio 中创建的 Office 解决方案使用的不同版本[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="949ea-344">Office solutions created in different versions of Visual Studio use different versions of the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span> <span data-ttu-id="949ea-345">每个版本的运行时提供不同版本`ServerDocument`的类, 旨在使用该版本的运行时的解决方案。</span><span class="sxs-lookup"><span data-stu-id="949ea-345">Each version of the runtime provides a different version of the `ServerDocument` class that is designed to work with solutions for that version of the runtime.</span></span> <span data-ttu-id="949ea-346">此版本的<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>类可用于使用创建[!INCLUDE[vs_dev12](~/includes/vs-dev12-md.md)]的解决方案, [!INCLUDE[vs_dev10_long](~/includes/vs-dev10-long-md.md)]以及使用 Visual Studio 2008 创建的 2007 Microsoft Office 解决方案。</span><span class="sxs-lookup"><span data-stu-id="949ea-346">This version of the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> class can be used with solutions that are created by using [!INCLUDE[vs_dev12](~/includes/vs-dev12-md.md)], [!INCLUDE[vs_dev10_long](~/includes/vs-dev10-long-md.md)] and with 2007 Microsoft Office solutions that are created by using Visual Studio 2008.</span></span>  
  
 <span data-ttu-id="949ea-347">下表指定此方法的返回值的含义。</span><span class="sxs-lookup"><span data-stu-id="949ea-347">The following table specifies the meaning of the return values for this method.</span></span>  
  
|<span data-ttu-id="949ea-348">返回值</span><span class="sxs-lookup"><span data-stu-id="949ea-348">Return value</span></span>|<span data-ttu-id="949ea-349">说明</span><span class="sxs-lookup"><span data-stu-id="949ea-349">Description</span></span>|  
|------------------|-----------------|  
|<span data-ttu-id="949ea-350">0</span><span class="sxs-lookup"><span data-stu-id="949ea-350">0</span></span>|<span data-ttu-id="949ea-351">文档没有自定义。</span><span class="sxs-lookup"><span data-stu-id="949ea-351">The document does not have a customization.</span></span>|  
|<span data-ttu-id="949ea-352">1</span><span class="sxs-lookup"><span data-stu-id="949ea-352">1</span></span>|<span data-ttu-id="949ea-353">文档具有使用 Visual Studio Tools for Office 版本2003创建的自定义项。</span><span class="sxs-lookup"><span data-stu-id="949ea-353">The document has a customization that was created by using Visual Studio Tools for Office, Version 2003.</span></span>|  
|<span data-ttu-id="949ea-354">2</span><span class="sxs-lookup"><span data-stu-id="949ea-354">2</span></span>|<span data-ttu-id="949ea-355">文档具有使用 Visual Studio 2005 Tools for Office Second Edition 运行时创建的自定义项。</span><span class="sxs-lookup"><span data-stu-id="949ea-355">The document has a customization that was created by using the Visual Studio 2005 Tools for Office Second Edition runtime.</span></span> <span data-ttu-id="949ea-356">这是在 Visual Studio 2005 Tools for Office 和 Visual Studio 2008 中, 自定义用于 Microsoft Office 2003 的运行时版本。</span><span class="sxs-lookup"><span data-stu-id="949ea-356">This is the version of the runtime that is used by customizations for Microsoft Office 2003 in Visual Studio 2005 Tools for Office and Visual Studio 2008.</span></span>|  
|<span data-ttu-id="949ea-357">3</span><span class="sxs-lookup"><span data-stu-id="949ea-357">3</span></span>|<span data-ttu-id="949ea-358">文档具有使用 Visual Studio 2010 Tools for Office Runtime 或 Microsoft Office 系统 (版本3.0 运行时) 的 Visual Studio Tools 创建的自定义项。</span><span class="sxs-lookup"><span data-stu-id="949ea-358">The document has a customization that was created by using the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span> <span data-ttu-id="949ea-359">版本3.0 的运行时由 Visual Studio 2008 中 2007 Microsoft Office 系统的自定义项使用。</span><span class="sxs-lookup"><span data-stu-id="949ea-359">Version 3.0 of the runtime is used by customizations for the 2007 Microsoft Office system in Visual Studio 2008.</span></span>|  
  
 <span data-ttu-id="949ea-360">有关不同版本[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)]的的详细信息, 请参阅[Visual Studio Tools for Office 运行时概述](/visualstudio/vsto/visual-studio-tools-for-office-runtime-overview)。</span><span class="sxs-lookup"><span data-stu-id="949ea-360">For more information about the different versions of the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)], see [Visual Studio Tools for Office Runtime Overview](/visualstudio/vsto/visual-studio-tools-for-office-runtime-overview).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-361">下面的代码示例创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>的, 它将加载指定的文档, 然后显示附加到文档的自定义项的部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="949ea-361">The following code example creates a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> that loads a specified document and then displays the URL of the deployment manifest for the customization that is attached to the document.</span></span> <span data-ttu-id="949ea-362">在创建对象之前, 代码使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A>方法来验证是否已使用 Visual Studio 2010 Tools for Office Runtime 创建了自定义。</span><span class="sxs-lookup"><span data-stu-id="949ea-362">Before creating the object, the code uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A> method to verify that the customization was created by using the Visual Studio 2010 Tools for Office Runtime.</span></span>  
  
 <span data-ttu-id="949ea-363">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-363">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-364">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-364">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-365">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-365">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-366">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-366">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-367">or</span><span class="sxs-lookup"><span data-stu-id="949ea-367">or</span></span>  
  
    -   <span data-ttu-id="949ea-368">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-368">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-369">`Imports`(对于 Visual Basic) 或`using` (对于C#) <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>代码文件顶部<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>的和命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-369">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#1](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#1)]
 [!code-vb[Trin_ServerDocument#1](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="949ea-370"><paramref name="documentPath" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="949ea-370">The <paramref name="documentPath" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="949ea-371"><paramref name="documentPath" /> 指定的文件不存在。</span><span class="sxs-lookup"><span data-stu-id="949ea-371">The file specified by <paramref name="documentPath" /> does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="949ea-372">[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 不支持 <paramref name="documentPath" /> 指定的文件的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="949ea-372">The file specified by <paramref name="documentPath" /> has a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="IsCacheEnabled">
      <MemberSignature Language="C#" Value="public static bool IsCacheEnabled (string documentPath);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool IsCacheEnabled(string documentPath) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.IsCacheEnabled(System.String)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="949ea-373">要检查的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="949ea-373">The full path of the document that you want to check.</span></span></param>
        <summary><span data-ttu-id="949ea-374">获取一个值，该值指示指定文档是否具有数据缓存。</span><span class="sxs-lookup"><span data-stu-id="949ea-374">Gets a value that indicates whether the specified document has a data cache.</span></span></summary>
        <returns><span data-ttu-id="949ea-375">如果指定文档具有数据缓存，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="949ea-375"><see langword="true" /> if the specified document has a data cache; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-376">此方法只指示文档是否具有数据缓存, 而非数据缓存是否确实包含数据。</span><span class="sxs-lookup"><span data-stu-id="949ea-376">This method indicates only whether the document has a data cache, not whether the data cache actually contains data.</span></span> <span data-ttu-id="949ea-377">如果文档的数据缓存中不包含数据, 则此方法仍返回`true`。</span><span class="sxs-lookup"><span data-stu-id="949ea-377">If the document has a data cache that contains no data in it, this method still returns `true`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-378">下面的代码示例创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>的, 然后<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData%2A>使用属性显示数据缓存的内容。</span><span class="sxs-lookup"><span data-stu-id="949ea-378">The following code example creates a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>, and then uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData%2A> property to display the contents of the data cache.</span></span> <span data-ttu-id="949ea-379">该示例首先使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.IsCacheEnabled%2A>方法来验证工作簿是否具有数据缓存。</span><span class="sxs-lookup"><span data-stu-id="949ea-379">The example first uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.IsCacheEnabled%2A> method to verify that the workbook has a data cache.</span></span>  
  
 <span data-ttu-id="949ea-380">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-380">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-381">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-381">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-382">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-382">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-383">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-383">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-384">or</span><span class="sxs-lookup"><span data-stu-id="949ea-384">or</span></span>  
  
    -   <span data-ttu-id="949ea-385">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-385">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-386">`Imports`(对于 Visual Basic) 或`using` (对于C#) <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>代码文件顶部<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>的和命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-386">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#5](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#5)]
 [!code-vb[Trin_ServerDocument#5](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="949ea-387"><paramref name="documentPath" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="949ea-387">The <paramref name="documentPath" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="949ea-388"><paramref name="documentPath" /> 指定的文件不存在。</span><span class="sxs-lookup"><span data-stu-id="949ea-388">The file specified by <paramref name="documentPath" /> does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="949ea-389"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="949ea-389">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="IsCustomized">
      <MemberSignature Language="C#" Value="public static bool IsCustomized (string documentPath);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool IsCustomized(string documentPath) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.IsCustomized(System.String)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="949ea-390">要检查自定义项的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="949ea-390">The full path of the document that you want to check for a customization.</span></span></param>
        <summary><span data-ttu-id="949ea-391">获取指示指定的文档是否具有用 Visual Studio 2010 Tools for Office Runtime 创建的自定义的值。</span><span class="sxs-lookup"><span data-stu-id="949ea-391">Gets a value that indicates whether the specified document has a customization that was created by using the Visual Studio 2010 Tools for Office Runtime.</span></span></summary>
        <returns><span data-ttu-id="949ea-392">如果文档具有使用 Visual Studio 2010 Tools for Office Runtime 生产的自定义，则为 <see langword="true" />；如果文档不具有自定义，则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="949ea-392"><see langword="true" /> if the document has a customization that was created by using the Visual Studio 2010 Tools for Office Runtime; <see langword="false" /> if the document does not have a customization.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-393">如果指定的文档具有未使用 Visual Studio 2010 Tools for Office Runtime 创建的自定义项或 Microsoft Office 系统的 Visual Studio Tools (版本3.0 运行时), 则此方法将引发异常。</span><span class="sxs-lookup"><span data-stu-id="949ea-393">This method throws an exception if the specified document has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span> <span data-ttu-id="949ea-394">例如, 如果指定的文档是使用 Visual Studio 2008 中的 Microsoft Office 2003 的项目模板创建的, 则此方法将引发异常, 因为这些项目模板使用 Visual Studio 2005 Tools for Office Second Edition 运行时。</span><span class="sxs-lookup"><span data-stu-id="949ea-394">For example, this method throws an exception if you specify a document that was created by using a project template for Microsoft Office 2003 in Visual Studio 2008, because these project templates use the Visual Studio 2005 Tools for Office Second Edition runtime.</span></span>  
  
 <span data-ttu-id="949ea-395">若要确定文档是否具有使用任意版本的 Visual Studio 创建的自定义项, 请使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A>方法而不是<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.IsCustomized%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="949ea-395">To determine whether a document has a customization that was created by using any version of Visual Studio, use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A> method instead of the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.IsCustomized%2A> method.</span></span> <span data-ttu-id="949ea-396"><xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A>如果文档没有自定义项, 则返回 0 (零)。</span><span class="sxs-lookup"><span data-stu-id="949ea-396"><xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A> returns 0 (zero) if the document does not have a customization.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="949ea-397"><paramref name="documentPath" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="949ea-397">The <paramref name="documentPath" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="949ea-398"><paramref name="documentPath" /> 中的文件不存在。</span><span class="sxs-lookup"><span data-stu-id="949ea-398">The file in <paramref name="documentPath" /> does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="949ea-399"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="949ea-399">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="RemoveCustomization">
      <MemberSignature Language="C#" Value="public static void RemoveCustomization (string documentPath);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void RemoveCustomization(string documentPath) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization(System.String)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="949ea-400">要移除自定义的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="949ea-400">The full path of the document from which you want to remove the customization.</span></span></param>
        <summary><span data-ttu-id="949ea-401">从文档移除自定义。</span><span class="sxs-lookup"><span data-stu-id="949ea-401">Removes the customization from the document.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-402">此方法清除部署清单 URL 和缓存的数据清单, 并从文档中删除任何缓存的数据。</span><span class="sxs-lookup"><span data-stu-id="949ea-402">This method clears the deployment manifest URL and the cached data manifest, and removes any cached data from the document.</span></span> <span data-ttu-id="949ea-403">有关详细信息，请参阅[如何：从文档](/visualstudio/vsto/how-to-remove-managed-code-extensions-from-documents)中删除托管代码扩展。</span><span class="sxs-lookup"><span data-stu-id="949ea-403">For more information, see [How to: Remove Managed Code Extensions from Documents](/visualstudio/vsto/how-to-remove-managed-code-extensions-from-documents).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-404">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization%2A>方法从指定的文档中删除自定义项。</span><span class="sxs-lookup"><span data-stu-id="949ea-404">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization%2A> method to remove the customization from the specified document.</span></span> <span data-ttu-id="949ea-405">该示例首先调用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A>方法来确定文档是否具有自定义项。</span><span class="sxs-lookup"><span data-stu-id="949ea-405">The example first calls the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A> method to determine whether the document has a customization.</span></span>  
  
 <span data-ttu-id="949ea-406">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-406">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-407">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-407">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-408">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-408">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-409">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-409">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-410">or</span><span class="sxs-lookup"><span data-stu-id="949ea-410">or</span></span>  
  
    -   <span data-ttu-id="949ea-411">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-411">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-412">`Imports`(对于 Visual Basic) 或`using` (对于C#) <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>代码文件顶部<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>的和命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-412">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#8](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#8)]
 [!code-vb[Trin_ServerDocument#8](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="949ea-413"><paramref name="documentPath" /> 参数为 <see langword="null" /> 或为空，或者完全由空格字符组成。</span><span class="sxs-lookup"><span data-stu-id="949ea-413">The <paramref name="documentPath" /> parameter is <see langword="null" /> or empty or consists completely of white space characters.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="949ea-414"><paramref name="documentPath" /> 指定的文件不存在。</span><span class="sxs-lookup"><span data-stu-id="949ea-414">The file specified by <paramref name="documentPath" /> does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="949ea-415"><paramref name="documentPath" /> 指定的文件为只读或无法访问。</span><span class="sxs-lookup"><span data-stu-id="949ea-415">The file specified by <paramref name="documentPath" /> is read-only, or cannot be accessed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="949ea-416"><paramref name="documentPath" /> 指定的文件不具有自定义，或加载清单时发生错误。</span><span class="sxs-lookup"><span data-stu-id="949ea-416">The file specified by <paramref name="documentPath" /> does not have a customization, or an error occurred while loading the manifest.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="949ea-417"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="949ea-417">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Save">
      <MemberSignature Language="C#" Value="public void Save ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Save() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Save" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="949ea-418">保存使用 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 类对文档所做的任何更改。</span><span class="sxs-lookup"><span data-stu-id="949ea-418">Saves any changes that were made to the document by using the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-419">方法<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Save%2A>将对缓存数据或部署清单 URL 所做的任何更改保存到文档中。</span><span class="sxs-lookup"><span data-stu-id="949ea-419">The <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Save%2A> method saves any changes you have made to the cached data or to the deployment manifest URL in the document.</span></span> <span data-ttu-id="949ea-420">如果使用磁盘上<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>的文档创建了对象, 则此方法会将这些更改保存到磁盘。</span><span class="sxs-lookup"><span data-stu-id="949ea-420">If you created the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> object by using a document on disk, this method saves these changes to disk.</span></span> <span data-ttu-id="949ea-421">如果使用内存中<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>的文档创建了对象, 则此方法会将这些更改保存到内存缓冲区。</span><span class="sxs-lookup"><span data-stu-id="949ea-421">If you created the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> object by using a document in memory, this method saves these changes to the memory buffer.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="949ea-422">下面的代码示例为指定的<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> Excel 工作簿创建新的, 通过<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A>使用方法修改在工作表中缓存的字符串的值, 然后使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Save%2A>方法保存更改。</span><span class="sxs-lookup"><span data-stu-id="949ea-422">The following code example creates a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> for a specified Excel workbook, modifies the value of a string that is cached in a worksheet by using the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A> method, and then saves the change by using the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Save%2A> method.</span></span>  
  
 <span data-ttu-id="949ea-423">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="949ea-423">This example requires:</span></span>  
  
-   <span data-ttu-id="949ea-424">一个 Excel 文档级自定义项, 它具有`Sheet1` `ExcelWorkbook1`命名空间中的一个类和一个名为`CachedString`的`Sheet1`类中的缓存字符串。</span><span class="sxs-lookup"><span data-stu-id="949ea-424">A document-level customization for Excel that has a `Sheet1` class in the `ExcelWorkbook1` namespace, and a cached string in the `Sheet1` class named `CachedString`.</span></span>  
  
-   <span data-ttu-id="949ea-425">一个控制台应用程序项目或一些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="949ea-425">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="949ea-426">对以下程序集的引用:</span><span class="sxs-lookup"><span data-stu-id="949ea-426">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="949ea-427">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="949ea-427">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="949ea-428">or</span><span class="sxs-lookup"><span data-stu-id="949ea-428">or</span></span>  
  
    -   <span data-ttu-id="949ea-429">VisualStudio (如果项目以 .NET Framework 3.5) 为目标, 则为 ServerDocument (如果该项目面向的是的 VisualStudio。) 的。</span><span class="sxs-lookup"><span data-stu-id="949ea-429">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="949ea-430">`Imports`(对于 Visual Basic) 或`using` (对于C#) <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>代码文件顶部<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>的和命名空间。</span><span class="sxs-lookup"><span data-stu-id="949ea-430">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#9](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#9)]
 [!code-vb[Trin_ServerDocument#9](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentClosedException"><span data-ttu-id="949ea-431"><see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 已关闭。</span><span class="sxs-lookup"><span data-stu-id="949ea-431">The <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> has been closed.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.MissingHostItemIdException"><span data-ttu-id="949ea-432"><see cref="P:Microsoft.VisualStudio.Tools.Applications.CachedDataHostItem.Id" /> 的 <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataHostItem" /> 属性为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="949ea-432">The <see cref="P:Microsoft.VisualStudio.Tools.Applications.CachedDataHostItem.Id" /> property of a <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataHostItem" /> is <see langword="null" /> or empty.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.MissingDataIdException"><span data-ttu-id="949ea-433"><see cref="P:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Id" /> 的 <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" /> 属性为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="949ea-433">The <see cref="P:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Id" /> property of a <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" /> is <see langword="null" /> or empty.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.MissingTypeException"><span data-ttu-id="949ea-434"><see cref="P:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.DataType" /> 的 <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" /> 属性为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="949ea-434">The <see cref="P:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.DataType" /> property of a <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" /> is <see langword="null" /> or empty.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="SolutionId">
      <MemberSignature Language="C#" Value="public Guid SolutionId { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid SolutionId" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualStudio.Tools.Applications.ServerDocument.SolutionId" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="949ea-435">获取一个 GUID，[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 可用其标识解决方案。</span><span class="sxs-lookup"><span data-stu-id="949ea-435">Gets a GUID that the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] uses to identify the solution.</span></span></summary>
        <value><span data-ttu-id="949ea-436">一个 GUID，[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 可用其标识解决方案。</span><span class="sxs-lookup"><span data-stu-id="949ea-436">A GUID that the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] uses to identify the solution.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-437"><xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.SolutionId%2A>属性的值是在解决方案的应用程序清单中的`vstov4:document`元素的`solutionId`属性中指定的同一 GUID。</span><span class="sxs-lookup"><span data-stu-id="949ea-437">The value of the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.SolutionId%2A> property is the same GUID that is specified in the `solutionId` attribute of the `vstov4:document` element in the application manifest for the solution.</span></span> <span data-ttu-id="949ea-438">有关详细信息, 请参阅[Office 解决方案中的应用程序和部署清单](/visualstudio/vsto/application-and-deployment-manifests-in-office-solutions)和[ \&lt; 文档\&g t;元素](/visualstudio/vsto/document-element-office-development-in-visual-studio)。</span><span class="sxs-lookup"><span data-stu-id="949ea-438">For more information, see [Application and Deployment Manifests in Office Solutions](/visualstudio/vsto/application-and-deployment-manifests-in-office-solutions) and [\&lt;document\&gt; Element](/visualstudio/vsto/document-element-office-development-in-visual-studio).</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="System.IDisposable.Dispose">
      <MemberSignature Language="C#" Value="void IDisposable.Dispose ();" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance void System.IDisposable.Dispose() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.System#IDisposable#Dispose" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.IDisposable.Dispose</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="949ea-439">释放由 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 使用的所有资源。</span><span class="sxs-lookup"><span data-stu-id="949ea-439">Releases all resources used by the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="949ea-440">不要直接在自己<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.System%23IDisposable%23Dispose%2A>的代码中调用方法。</span><span class="sxs-lookup"><span data-stu-id="949ea-440">Do not call the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.System%23IDisposable%23Dispose%2A> method directly in your own code.</span></span> <span data-ttu-id="949ea-441">使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>完后, 请改为<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close%2A>调用方法。</span><span class="sxs-lookup"><span data-stu-id="949ea-441">When you are finished using the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>, call the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close%2A> method instead.</span></span> <span data-ttu-id="949ea-442"><xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.System%23IDisposable%23Dispose%2A>当调用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close%2A>方法时, 将自动调用。</span><span class="sxs-lookup"><span data-stu-id="949ea-442"><xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.System%23IDisposable%23Dispose%2A> is called automatically when you call the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>
