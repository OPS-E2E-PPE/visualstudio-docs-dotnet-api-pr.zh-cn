<Type Name="ServerDocument" FullName="Microsoft.VisualStudio.Tools.Applications.ServerDocument">
  <Metadata><Meta Name="ms.openlocfilehash" Value="a8fda5d830528a6ee257126a7eaaf30e3901979e" /><Meta Name="ms.sourcegitcommit" Value="66ccc1ab172558cdfd2b9ffb616a60e4c9105be3" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="09/19/2018" /><Meta Name="ms.locfileid" Value="46457899" /></Metadata><TypeSignature Language="C#" Value="public sealed class ServerDocument : IDisposable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit ServerDocument extends System.Object implements class System.IDisposable" />
  <TypeSignature Language="DocId" Value="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" />
  <AssemblyInfo>
    <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
    <AssemblyVersion>10.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.IDisposable</InterfaceName>
    </Interface>
  </Interfaces>
  <Docs>
    <summary><span data-ttu-id="aeab0-101">提供对文档或工作簿（属于使用 Visual Studio 中的 Office 开发工具创建的文档级自定义项）中的缓存数据和自定义项信息的访问。</span><span class="sxs-lookup"><span data-stu-id="aeab0-101">Provides access to the cached data and customization information in a document or workbook that is part of a document-level customization created by using the Office development tools in Visual Studio.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-102">使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>类来管理未安装 Excel 的计算机上的文档级自定义的某些方面或安装 Word。</span><span class="sxs-lookup"><span data-stu-id="aeab0-102">Use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> class to manage certain aspects of document-level customizations on a computer that does not have Excel or Word installed.</span></span> <span data-ttu-id="aeab0-103">通常情况下，应用程序不与集成 Office，如控制台项目或 Windows 窗体项目，而不是 Office 项目中需要使用此类。</span><span class="sxs-lookup"><span data-stu-id="aeab0-103">You typically use this class in applications that do not integrate with Office, such as Console projects or Windows Forms projects, rather than Office projects.</span></span>  
  
 <span data-ttu-id="aeab0-104">使用下列成员的<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>类来执行常见任务：</span><span class="sxs-lookup"><span data-stu-id="aeab0-104">Use the following members of the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> class to perform common tasks:</span></span>  
  
-   <span data-ttu-id="aeab0-105">若要访问和修改的服务器上的文档数据缓存中的数据，请使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="aeab0-105">To access and modify data in the data cache of a document on a server, use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData%2A> property.</span></span>  
  
-   <span data-ttu-id="aeab0-106">若要以编程方式将自定义项附加到文档或从文档中删除自定义项，使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>和<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="aeab0-106">To programmatically attach a customization to a document or remove a customization from a document, use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> and <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization%2A> methods.</span></span>  
  
-   <span data-ttu-id="aeab0-107">若要访问或更改与文档相关联的部署清单的 URL，请使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.DeploymentManifestUrl%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="aeab0-107">To access or change the URL of the deployment manifest that is associated with the document, use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.DeploymentManifestUrl%2A> property.</span></span>  
  
 <span data-ttu-id="aeab0-108">有两个不同版本<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>Visual Studio 2010 Tools for Office Runtime 中的类。</span><span class="sxs-lookup"><span data-stu-id="aeab0-108">There are two different versions of the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> class in the Visual Studio 2010 Tools for Office Runtime.</span></span> <span data-ttu-id="aeab0-109">应使用的版本取决于目标的应用程序的.NET Framework 中想要使用的类：</span><span class="sxs-lookup"><span data-stu-id="aeab0-109">The version you should use depends on the target .NET Framework of the application in which you want to use the class:</span></span>  
  
-   <span data-ttu-id="aeab0-110">对于面向应用程序[!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)]或[!INCLUDE[net_v45](~/includes/net-v45-md.md)]，使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument?displayProperty=fullName>Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 程序集中的类。</span><span class="sxs-lookup"><span data-stu-id="aeab0-110">For applications that target the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)], use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument?displayProperty=fullName> class in the Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll assembly.</span></span>  
  
-   <span data-ttu-id="aeab0-111">对于面向.NET Framework 3.5 的应用程序，使用`Microsoft.VisualStudio.Tools.Applications.ServerDocument`Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 程序集中的类。</span><span class="sxs-lookup"><span data-stu-id="aeab0-111">For applications that target the .NET Framework 3.5, use the `Microsoft.VisualStudio.Tools.Applications.ServerDocument` class in the Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll assembly.</span></span>  
  
 <span data-ttu-id="aeab0-112">有关详细信息，请参阅 [使用 ServerDocument 类管理服务器上的文档](/visualstudio/vsto/managing-documents-on-a-server-by-using-the-serverdocument-class)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-112">For more information, see [Managing Documents on a Server by Using the ServerDocument Class](/visualstudio/vsto/managing-documents-on-a-server-by-using-the-serverdocument-class).</span></span>  
  
## <a name="choosing-which-constructor-to-use"></a><span data-ttu-id="aeab0-113">选择使用的构造函数</span><span class="sxs-lookup"><span data-stu-id="aeab0-113">Choosing Which Constructor to Use</span></span>  
 <span data-ttu-id="aeab0-114">若要使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>类来访问缓存的数据或部署清单在文档中的 URL，则必须创建<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>对象。</span><span class="sxs-lookup"><span data-stu-id="aeab0-114">To use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> class to access the cached data or the deployment manifest URL in a document, you must create a <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> object.</span></span>  
  
 <span data-ttu-id="aeab0-115">有两个组的<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>构造函数：</span><span class="sxs-lookup"><span data-stu-id="aeab0-115">There are two sets of <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> constructors:</span></span>  
  
-   <span data-ttu-id="aeab0-116">一组可用于访问已在内存中打开的文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-116">A set that you can use to access a document that has already been opened in memory.</span></span>  
  
-   <span data-ttu-id="aeab0-117">一组可用于访问磁盘上的文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-117">A set that you can use to access a document that is on disk.</span></span>  
  
### <a name="accessing-a-document-in-memory"></a><span data-ttu-id="aeab0-118">访问内存中的文档</span><span class="sxs-lookup"><span data-stu-id="aeab0-118">Accessing a Document in Memory</span></span>  
 <span data-ttu-id="aeab0-119">若要访问已在内存中打开的文档，请使用以下构造函数之一：</span><span class="sxs-lookup"><span data-stu-id="aeab0-119">To access a document that has already been opened in memory, use one of the following constructors:</span></span>  
  
-   <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.Byte%5B%5D%2CSystem.String%29?displayProperty=fullName>  
  
-   <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.IO.Stream%2CSystem.String%29?displayProperty=fullName>  
  
 <span data-ttu-id="aeab0-120">这些构造函数接受字节数组或<xref:System.IO.Stream>表示在内存中的文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-120">These constructors accept a byte array or a <xref:System.IO.Stream> that represents the document in memory.</span></span> <span data-ttu-id="aeab0-121">这是很有用，如果你想要修改的缓存的数据或应用程序清单中文档，再进行流式传输到目标使用 HTTP 协议。</span><span class="sxs-lookup"><span data-stu-id="aeab0-121">This is useful if you want to modify the cached data or application manifest in the document before streaming it to a destination by using the HTTP protocol.</span></span> <span data-ttu-id="aeab0-122">若要使用这些构造函数，该文档必须已有自定义项;否则，这些构造函数将引发<xref:Microsoft.VisualStudio.Tools.Applications.Runtime.CannotLoadManifestException>异常。</span><span class="sxs-lookup"><span data-stu-id="aeab0-122">To use these constructors, the document must already have a customization; otherwise, these constructors will throw a <xref:Microsoft.VisualStudio.Tools.Applications.Runtime.CannotLoadManifestException> exception.</span></span>  
  
### <a name="accessing-a-document-on-disk"></a><span data-ttu-id="aeab0-123">访问磁盘上的文档</span><span class="sxs-lookup"><span data-stu-id="aeab0-123">Accessing a Document on Disk</span></span>  
 <span data-ttu-id="aeab0-124">若要访问磁盘上的文档，请使用以下构造函数之一：</span><span class="sxs-lookup"><span data-stu-id="aeab0-124">To access a document that is on disk, use one of the following constructors:</span></span>  
  
-   <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%29?displayProperty=fullName>  
  
-   <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%2CSystem.IO.FileAccess%29?displayProperty=fullName>  
  
 <span data-ttu-id="aeab0-125">这些构造函数接受你想要打开的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="aeab0-125">These constructors accept the full path of the document that you want to open.</span></span> <span data-ttu-id="aeab0-126">默认情况下，具有读/写访问权限打开文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-126">By default, the document is opened with read/write access.</span></span> <span data-ttu-id="aeab0-127">如果你想要使用只读或只写访问打开的文档，使用构造函数具有<xref:System.IO.FileAccess>参数。</span><span class="sxs-lookup"><span data-stu-id="aeab0-127">If you want to open the document with read-only or write-only access, use the constructor that has a <xref:System.IO.FileAccess> parameter.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-128">下面的代码示例创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>的加载指定的文档，然后显示附加到文档的自定义项的部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="aeab0-128">The following code example creates a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> that loads a specified document and then displays the URL of the deployment manifest for the customization that is attached to the document.</span></span>  
  
 <span data-ttu-id="aeab0-129">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-129">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-130">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-130">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-131">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-131">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-132">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-132">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-133">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-133">or</span></span>  
  
    -   <span data-ttu-id="aeab0-134">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-134">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-135">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-135">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#1](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#1)]
 [!code-vb[Trin_ServerDocument#1](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#1)]  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ServerDocument (string documentPath);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string documentPath) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.#ctor(System.String)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="aeab0-136">要加载的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="aeab0-136">The full path of the document to be loaded.</span></span></param>
        <summary><span data-ttu-id="aeab0-137">使用要加载的文档的完整路径，初始化 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="aeab0-137">Initializes a new instance of the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> class using the full path of the document to be loaded.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-138">使用此构造函数来访问在磁盘上的文档中的缓存的数据或部署清单信息。</span><span class="sxs-lookup"><span data-stu-id="aeab0-138">Use this constructor to access the cached data or deployment manifest information in a document that is on disk.</span></span> <span data-ttu-id="aeab0-139">当使用此构造函数时，具有读/写访问权限打开指定的文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-139">When you use this constructor, the specified document is opened with read/write access.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-140">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%29>构造函数创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>加载指定的文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-140">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%29> constructor to create a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> that loads a specified document.</span></span> <span data-ttu-id="aeab0-141">该示例然后显示附加到文档的自定义项的部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="aeab0-141">The example then displays the URL of the deployment manifest for the customization that is attached to the document.</span></span>  
  
 <span data-ttu-id="aeab0-142">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-142">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-143">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-143">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-144">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-144">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-145">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-145">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-146">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-146">or</span></span>  
  
    -   <span data-ttu-id="aeab0-147">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-147">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-148">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-148">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#1](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#1)]
 [!code-vb[Trin_ServerDocument#1](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="aeab0-149"><paramref name="documentPath" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="aeab0-149">The <paramref name="documentPath" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="aeab0-150"><paramref name="documentPath" /> 指定的文件不存在。</span><span class="sxs-lookup"><span data-stu-id="aeab0-150">The file specified by <paramref name="documentPath" /> does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="aeab0-151"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="aeab0-151">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="aeab0-152">[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 不支持 <paramref name="documentPath" /> 指定的文件的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="aeab0-152">The file specified by <paramref name="documentPath" /> has a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ServerDocument (byte[] bytes, string fileType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(unsigned int8[] bytes, string fileType) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.#ctor(System.Byte[],System.String)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="bytes" Type="System.Byte[]" />
        <Parameter Name="fileType" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="bytes"><span data-ttu-id="aeab0-153">一个表示要加载的文档的字节数组。</span><span class="sxs-lookup"><span data-stu-id="aeab0-153">A byte array that represents the document to be loaded.</span></span></param>
        <param name="fileType"><span data-ttu-id="aeab0-154">文档的文件扩展名，存储在 <c>bytes</c> 参数中，前面有一个句点 (.)，例如“.xlsx”或“.docx”。</span><span class="sxs-lookup"><span data-stu-id="aeab0-154">The file name extension of the document that is stored in the <c>bytes</c> parameter, preceded by a period (.)—for example, ".xlsx" or ".docx".</span></span></param>
        <summary><span data-ttu-id="aeab0-155">使用表示要加载的文档的字节数组和该文档的文件扩展名，初始化 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="aeab0-155">Initializes a new instance of the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> class using a byte array that represents the document to be loaded and the file name extension of the document.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-156">使用此构造函数来访问已在内存中的文档中的缓存的数据或部署清单信息。</span><span class="sxs-lookup"><span data-stu-id="aeab0-156">Use this constructor to access the cached data or deployment manifest information in a document that is already in memory.</span></span> <span data-ttu-id="aeab0-157">当使用此构造函数时，具有读/写访问权限打开文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-157">When you use this constructor, the document is opened with read/write access.</span></span>  
  
 <span data-ttu-id="aeab0-158">`fileType`参数仅用于确定存储在字节数组中的文档的类型。</span><span class="sxs-lookup"><span data-stu-id="aeab0-158">The `fileType` parameter is used only to determine the type of document that is stored in the byte array.</span></span> <span data-ttu-id="aeab0-159">值`fileType`映射到一个对于文档级自定义支持的文件类型。</span><span class="sxs-lookup"><span data-stu-id="aeab0-159">The value of `fileType` is mapped to one of the file types that are supported for document-level customizations.</span></span> <span data-ttu-id="aeab0-160">不会尝试打开文件。</span><span class="sxs-lookup"><span data-stu-id="aeab0-160">No attempt is made to open the file.</span></span> <span data-ttu-id="aeab0-161">您可以选择性地传递中完整的文件名称 (例如，"Workbook1.xlsx")，但如果这样做，则使用文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="aeab0-161">You can optionally pass in a complete file name (for example, "Workbook1.xlsx"), but if you do this, only the file name extension is used.</span></span> <span data-ttu-id="aeab0-162">有关受支持的文件类型的详细信息，请参阅[Architecture of Document-level Customizations](/visualstudio/vsto/architecture-of-document-level-customizations)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-162">For more information about the supported file types, see [Architecture of Document-Level Customizations](/visualstudio/vsto/architecture-of-document-level-customizations).</span></span>  
  
 <span data-ttu-id="aeab0-163">若要在调用此构造函数后访问该文档的字节数组，使用 [ServerDocument 构造函数 (字节\<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A > 属性。</span><span class="sxs-lookup"><span data-stu-id="aeab0-163">To access the byte array for the document after calling this constructor, use the [ServerDocument Constructor (Byte\<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-164">下面的代码示例使用 [ServerDocument 构造函数 (字节\<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.Byte%5B%5D%2CSystem.String%29 > 构造函数来创建新的 [ServerDocument构造函数 (字节\<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument > 从字节数组，其中包含文件扩展名为.xlsx 的 Excel 工作簿。</span><span class="sxs-lookup"><span data-stu-id="aeab0-164">The following code example uses the [ServerDocument Constructor (Byte\<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.Byte%5B%5D%2CSystem.String%29> constructor to create a new [ServerDocument Constructor (Byte\<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> from a byte array that contains an Excel workbook with the .xlsx file name extension.</span></span> <span data-ttu-id="aeab0-165">然后该示例使用 [ServerDocument 构造函数 (字节\<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A > 属性显示在文档中的字节数。</span><span class="sxs-lookup"><span data-stu-id="aeab0-165">The example then uses the [ServerDocument Constructor (Byte\<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A> property to display the number of bytes in the document.</span></span>  
  
 <span data-ttu-id="aeab0-166">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-166">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-167">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-167">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-168">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-168">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-169">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-169">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-170">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-170">or</span></span>  
  
    -   <span data-ttu-id="aeab0-171">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-171">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-172">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句 [ServerDocument 构造函数 (字节\<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName > 和 [ServerDocument 构造函数 (字节\<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName > 你的代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-172">`Imports` (for Visual Basic) or `using` (for C#) statements for [ServerDocument Constructor (Byte\<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and [ServerDocument Constructor (Byte\<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#2](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#2)]
 [!code-vb[Trin_ServerDocument#2](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="aeab0-173"><paramref name="bytes" /> 参数为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="aeab0-173">The <paramref name="bytes" /> parameter is <see langword="null" /> or empty.</span></span>  
  
<span data-ttu-id="aeab0-174">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-174">-or-</span></span> 
<span data-ttu-id="aeab0-175"><paramref name="fileType" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="aeab0-175">The <paramref name="fileType" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="aeab0-176">[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 不支持 <paramref name="fileType" /> 参数指定的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="aeab0-176">The <paramref name="fileType" /> parameter specifies a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="aeab0-177"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="aeab0-177">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ServerDocument (System.IO.Stream stream, string fileType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.IO.Stream stream, string fileType) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.#ctor(System.IO.Stream,System.String)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="stream" Type="System.IO.Stream" />
        <Parameter Name="fileType" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="stream"><span data-ttu-id="aeab0-178">表示要加载的文档的流。</span><span class="sxs-lookup"><span data-stu-id="aeab0-178">A stream that represents the document to be loaded.</span></span></param>
        <param name="fileType"><span data-ttu-id="aeab0-179">文档的文件扩展名，存储在 <c>bytes</c> 参数中，前面有一个句点 (.)，例如“.xlsx”或“.docx”。</span><span class="sxs-lookup"><span data-stu-id="aeab0-179">The file name extension of the document that is stored in the <c>bytes</c> parameter, preceded by a period (.)—for example, ".xlsx" or ".docx".</span></span></param>
        <summary><span data-ttu-id="aeab0-180">使用表示要加载的文档的流和该文档的文件扩展名，初始化 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="aeab0-180">Initializes a new instance of the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> class using a stream that represents the document to be loaded and the file name extension of the document.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-181">使用此构造函数来访问已在内存中的文档中的缓存的数据或部署清单信息。</span><span class="sxs-lookup"><span data-stu-id="aeab0-181">Use this constructor to access the cached data or deployment manifest information in a document that is already in memory.</span></span> <span data-ttu-id="aeab0-182">当使用此构造函数时，具有读/写访问权限打开文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-182">When you use this constructor, the document is opened with read/write access.</span></span>  
  
 <span data-ttu-id="aeab0-183">`fileType`参数仅用于确定存储在字节数组中的文档的类型。</span><span class="sxs-lookup"><span data-stu-id="aeab0-183">The `fileType` parameter is used only to determine the type of document that is stored in the byte array.</span></span> <span data-ttu-id="aeab0-184">值`fileType`映射到一个对于文档级自定义支持的文件类型。</span><span class="sxs-lookup"><span data-stu-id="aeab0-184">The value of `fileType` is mapped to one of the file types that are supported for document-level customizations.</span></span> <span data-ttu-id="aeab0-185">不会尝试打开文件。</span><span class="sxs-lookup"><span data-stu-id="aeab0-185">No attempt is made to open the file.</span></span> <span data-ttu-id="aeab0-186">您可以选择性地传递中完整的文件名称 (例如，"Workbook1.xlsx")，但如果这样做，则使用文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="aeab0-186">You can optionally pass in a complete file name (for example, "Workbook1.xlsx"), but if you do this, only the file name extension is used.</span></span> <span data-ttu-id="aeab0-187">有关受支持的文件类型的详细信息，请参阅[Architecture of Document-level Customizations](/visualstudio/vsto/architecture-of-document-level-customizations)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-187">For more information about the supported file types, see [Architecture of Document-Level Customizations](/visualstudio/vsto/architecture-of-document-level-customizations).</span></span>  
  
 <span data-ttu-id="aeab0-188">若要在调用此构造函数后访问该文档的字节数组，使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="aeab0-188">To access the byte array for the document after calling this constructor, use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-189">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.IO.Stream%2CSystem.String%29>构造函数创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>从<xref:System.IO.FileStream>，其中包含文件扩展名为.xlsx 的 Excel 工作簿。</span><span class="sxs-lookup"><span data-stu-id="aeab0-189">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.IO.Stream%2CSystem.String%29> constructor to create a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> from a <xref:System.IO.FileStream> that contains an Excel workbook with the .xlsx file name extension.</span></span> <span data-ttu-id="aeab0-190">然后，该代码显示附加到文档的自定义项的部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="aeab0-190">The code then displays the URL of the deployment manifest for the customization that is attached to the document.</span></span>  
  
 <span data-ttu-id="aeab0-191">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-191">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-192">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-192">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-193">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-193">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-194">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-194">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-195">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-195">or</span></span>  
  
    -   <span data-ttu-id="aeab0-196">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-196">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-197">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-197">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#3](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#3)]
 [!code-vb[Trin_ServerDocument#3](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="aeab0-198"><paramref name="stream" /> 参数为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="aeab0-198">The <paramref name="stream" /> parameter is <see langword="null" /> or empty.</span></span>  
  
<span data-ttu-id="aeab0-199">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-199">-or-</span></span> 
<span data-ttu-id="aeab0-200"><paramref name="fileType" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="aeab0-200">The <paramref name="fileType" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="aeab0-201"><paramref name="stream" /> 参数的长度为零或其当前位置位于流的末尾。</span><span class="sxs-lookup"><span data-stu-id="aeab0-201">The <paramref name="stream" /> parameter has zero length or its current position is at the stream's end.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="aeab0-202">[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 不支持 <paramref name="fileType" /> 参数指定的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="aeab0-202">The <paramref name="fileType" /> parameter specifies a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="aeab0-203"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="aeab0-203">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ServerDocument (string documentPath, System.IO.FileAccess access);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string documentPath, valuetype System.IO.FileAccess access) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.#ctor(System.String,System.IO.FileAccess)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
        <Parameter Name="access" Type="System.IO.FileAccess" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="aeab0-204">要加载的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="aeab0-204">The full path of the document to be loaded.</span></span></param>
        <param name="access"><span data-ttu-id="aeab0-205">一个指示对文档的文件访问权限的值。</span><span class="sxs-lookup"><span data-stu-id="aeab0-205">A value that indicates the file access for the document.</span></span></param>
        <summary><span data-ttu-id="aeab0-206">使用要加载的文档的完整路径和一个指示对该文档的文件访问权限的值，初始化 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="aeab0-206">Initializes a new instance of the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> class using the full path of the document to be loaded and a value that indicates the file access for the document.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-207">使用此构造函数来访问位于磁盘，如果你想要使用只读或只写访问打开的文档的文档中的缓存的数据或部署清单信息。</span><span class="sxs-lookup"><span data-stu-id="aeab0-207">Use this constructor to access the cached data or deployment manifest information in a document that is on disk if you want to open the document with read-only or write-only access.</span></span> <span data-ttu-id="aeab0-208">默认情况下，其他<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>构造函数具有读/写访问权限打开的文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-208">By default, the other <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> constructors open the document with read/write access.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-209">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%2CSystem.IO.FileAccess%29>构造函数创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>加载指定的文档具有只读访问权限。</span><span class="sxs-lookup"><span data-stu-id="aeab0-209">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%2CSystem.IO.FileAccess%29> constructor to create a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> that loads a specified document with read-only access.</span></span> <span data-ttu-id="aeab0-210">然后，该代码显示附加到文档的自定义项的部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="aeab0-210">The code then displays the URL of the deployment manifest for the customization that is attached to the document.</span></span>  
  
 <span data-ttu-id="aeab0-211">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-211">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-212">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-212">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-213">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-213">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-214">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-214">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-215">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-215">or</span></span>  
  
    -   <span data-ttu-id="aeab0-216">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-216">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-217">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-217">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#4](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#4)]
 [!code-vb[Trin_ServerDocument#4](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="aeab0-218"><paramref name="documentPath" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="aeab0-218">The <paramref name="documentPath" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="aeab0-219"><paramref name="access" /> 的值是 <c>System.IO.FileAccess.Write</c>。</span><span class="sxs-lookup"><span data-stu-id="aeab0-219">The value of <paramref name="access" /> is <c>System.IO.FileAccess.Write</c>.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="aeab0-220"><paramref name="documentPath" /> 指定的文件不存在。</span><span class="sxs-lookup"><span data-stu-id="aeab0-220">The file specified by <paramref name="documentPath" /> does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentNotCustomizedException"><span data-ttu-id="aeab0-221"><paramref name="documentPath" /> 参数指定的文件不具有自定义，并且 <paramref name="access" /> 的值为 <c>System.IO.FileAccess.Read</c>。</span><span class="sxs-lookup"><span data-stu-id="aeab0-221">The file specified by the <paramref name="documentPath" /> parameter does not have a customization, and the value of <paramref name="access" /> is <c>System.IO.FileAccess.Read</c>.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="aeab0-222"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="aeab0-222">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="aeab0-223">[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 不支持 <paramref name="documentPath" /> 指定的文件的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="aeab0-223">The file specified by <paramref name="documentPath" /> has a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="AddCustomization">
      <MemberSignature Language="C#" Value="public static void AddCustomization (string documentPath, Uri deploymentManifestUrl);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void AddCustomization(string documentPath, class System.Uri deploymentManifestUrl) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization(System.String,System.Uri)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
        <Parameter Name="deploymentManifestUrl" Type="System.Uri" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="aeab0-224">要向其附加自定义的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="aeab0-224">The full path of the document to which you want to attach a customization.</span></span></param>
        <param name="deploymentManifestUrl"><span data-ttu-id="aeab0-225">解决方案部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="aeab0-225">The URL of the deployment manifest for the solution.</span></span></param>
        <summary><span data-ttu-id="aeab0-226">使用指定的程序集名称和部署清单，将自定义项附加到指定文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-226">Attaches a customization to the specified document by using the specified assembly name and deployment manifest.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-227"><xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>方法将指定的自定义与文档关联通过添加`_AssemblyName`和`_AssemblyLocation`到文档的自定义文档属性。</span><span class="sxs-lookup"><span data-stu-id="aeab0-227">The <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method associates the specified customization with the document by adding the `_AssemblyName` and `_AssemblyLocation` custom document properties to the document.</span></span> <span data-ttu-id="aeab0-228">这些属性确定文档具有自定义和指定部署清单的位置。</span><span class="sxs-lookup"><span data-stu-id="aeab0-228">These properties identify that the document has a customization and specify the location of the deployment manifest.</span></span> <span data-ttu-id="aeab0-229">调用此方法成功，的下次用户打开指定的文档后运行时将尝试安装 Office 解决方案。</span><span class="sxs-lookup"><span data-stu-id="aeab0-229">After this method is successfully called, the next time a user opens the specified document, the runtime will attempt to install the Office solution.</span></span> <span data-ttu-id="aeab0-230">有关自定义文档属性的详细信息，请参阅[自定义文档属性概述](/visualstudio/vsto/custom-document-properties-overview)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-230">For more information about the custom document properties, see [Custom Document Properties Overview](/visualstudio/vsto/custom-document-properties-overview).</span></span>  
  
 <span data-ttu-id="aeab0-231">如果指定的文档不包含自定义项要求文档，一个控件<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>方法将成功，但该程序集将加载在用户打开文档时失败。</span><span class="sxs-lookup"><span data-stu-id="aeab0-231">If the specified document does not contain a control that the customization expects the document to have, the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method will succeed, but the assembly will fail to load when the user opens the document.</span></span>  
  
 <span data-ttu-id="aeab0-232">`fileType`参数必须指定具有对于文档级自定义支持的文件扩展名的文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-232">The `fileType` parameter must specify a document that has a file name extension that is supported for document-level customizations.</span></span> <span data-ttu-id="aeab0-233">无法将自定义项附加到 Word XML 文档中保存的文档 (\* xml) 或 Word 2003 XML 文档 (\*xml) 文件格式。</span><span class="sxs-lookup"><span data-stu-id="aeab0-233">You cannot attach a customization to a document that is saved in the Word XML Document (\*xml) or Word 2003 XML Document (\*xml) file formats.</span></span> <span data-ttu-id="aeab0-234">有关受支持的文件类型的详细信息，请参阅[Architecture of Document-level Customizations](/visualstudio/vsto/architecture-of-document-level-customizations)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-234">For more information about the supported file types, see [Architecture of Document-Level Customizations](/visualstudio/vsto/architecture-of-document-level-customizations).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-235">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>方法将自定义项附加到指定的文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-235">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method to attach a customization to the specified document.</span></span>  
  
 <span data-ttu-id="aeab0-236">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-236">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-237">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-237">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-238">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-238">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-239">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-239">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-240">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-240">or</span></span>  
  
    -   <span data-ttu-id="aeab0-241">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-241">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-242">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-242">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#6](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#6)]
 [!code-vb[Trin_ServerDocument#6](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#6)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="aeab0-243"><paramref name="documentPath" /> 或 <paramref name="deploymentManifestUrl" /> 为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="aeab0-243"><paramref name="documentPath" /> or <paramref name="deploymentManifestUrl" /> is <see langword="null" /> or empty.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="aeab0-244"><paramref name="deploymentManifestUrl" /> 未指定绝对 URL。</span><span class="sxs-lookup"><span data-stu-id="aeab0-244"><paramref name="deploymentManifestUrl" /> does not specify an absolute URL.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="aeab0-245"><paramref name="documentPath" /> 或 <paramref name="deploymentManifestUrl" /> 表示一个不存在的文件。</span><span class="sxs-lookup"><span data-stu-id="aeab0-245"><paramref name="documentPath" /> or <paramref name="deploymentManifestUrl" /> refers to a file that does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentAlreadyCustomizedException"><span data-ttu-id="aeab0-246"><paramref name="documentPath" /> 指定的文档已具有自定义。</span><span class="sxs-lookup"><span data-stu-id="aeab0-246">The document specified by <paramref name="documentPath" /> already has a customization.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.InvalidManifestException"><span data-ttu-id="aeab0-247"><paramref name="deploymentManifestUrl" /> 指定的部署清单不是有效的部署清单。</span><span class="sxs-lookup"><span data-stu-id="aeab0-247">The deployment manifest specified by <paramref name="deploymentManifestUrl" /> is not a valid deployment manifest.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentNotCustomizedException"><span data-ttu-id="aeab0-248"><paramref name="documentPath" /> 指定的文档已损坏，或具有受限权限。</span><span class="sxs-lookup"><span data-stu-id="aeab0-248">The document specified by <paramref name="documentPath" /> is corrupt, or has restricted permissions.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="aeab0-249"><paramref name="documentPath" /> 指定的文档具有不受 [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 支持的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="aeab0-249">The document specified by <paramref name="documentPath" /> has a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="AddCustomization">
      <MemberSignature Language="C#" Value="public static void AddCustomization (string documentPath, string assemblyName, Guid solutionId, Uri deploymentManifestUrl);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void AddCustomization(string documentPath, string assemblyName, valuetype System.Guid solutionId, class System.Uri deploymentManifestUrl) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization(System.String,System.String,System.Guid,System.Uri)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
        <Parameter Name="assemblyName" Type="System.String" />
        <Parameter Name="solutionId" Type="System.Guid" />
        <Parameter Name="deploymentManifestUrl" Type="System.Uri" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="aeab0-250">要向其附加自定义的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="aeab0-250">The full path of the document to which you want to attach a customization.</span></span></param>
        <param name="assemblyName"><span data-ttu-id="aeab0-251">用于自定义的程序集的完整路径。</span><span class="sxs-lookup"><span data-stu-id="aeab0-251">The full path of the assembly for the customization.</span></span> <span data-ttu-id="aeab0-252">该路径必须位于本地文件系统或 UNC 共享上；不能指定 HTTP 位置。</span><span class="sxs-lookup"><span data-stu-id="aeab0-252">The path must be on the local file system or a UNC share; you cannot specify an HTTP location.</span></span></param>
        <param name="solutionId"><span data-ttu-id="aeab0-253">一个 GUID，[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 可用其标识解决方案。</span><span class="sxs-lookup"><span data-stu-id="aeab0-253">A GUID that the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] uses to identify the solution.</span></span></param>
        <param name="deploymentManifestUrl"><span data-ttu-id="aeab0-254">解决方案部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="aeab0-254">The URL of the deployment manifest for the solution.</span></span></param>
        <summary><span data-ttu-id="aeab0-255">通过使用指定文档、程序集名称、解决方案 ID 和部署清单，将自定义附加到指定文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-255">Attaches a customization to the specified document by using the specified document, assembly name, solution ID, and deployment manifest.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-256"><xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>方法将指定的自定义与文档关联通过添加`_AssemblyName`和`_AssemblyLocation`到文档的自定义文档属性。</span><span class="sxs-lookup"><span data-stu-id="aeab0-256">The <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method associates the specified customization with the document by adding the `_AssemblyName` and `_AssemblyLocation` custom document properties to the document.</span></span> <span data-ttu-id="aeab0-257">这些属性确定文档具有自定义和指定部署清单的位置。</span><span class="sxs-lookup"><span data-stu-id="aeab0-257">These properties identify that the document has a customization and specify the location of the deployment manifest.</span></span> <span data-ttu-id="aeab0-258">调用此方法成功，的下次用户打开指定的文档后运行时将尝试安装 Office 解决方案。</span><span class="sxs-lookup"><span data-stu-id="aeab0-258">After this method is successfully called, the next time a user opens the specified document, the runtime attempts to install the Office solution.</span></span> <span data-ttu-id="aeab0-259">有关自定义文档属性的详细信息，请参阅[自定义文档属性概述](/visualstudio/vsto/custom-document-properties-overview)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-259">For more information about the custom document properties, see [Custom Document Properties Overview](/visualstudio/vsto/custom-document-properties-overview).</span></span>  
  
 <span data-ttu-id="aeab0-260">GUID 传递给`solutionID`附加到文档的解决方案的应用程序清单中指定参数。</span><span class="sxs-lookup"><span data-stu-id="aeab0-260">The GUID that you pass to the `solutionID` parameter is specified in the application manifest of the solution that you are attaching to the document.</span></span> <span data-ttu-id="aeab0-261">你必须传递中指定的同一个 GUID`solutionId`属性的`vstov4:document`应用程序清单中的元素。</span><span class="sxs-lookup"><span data-stu-id="aeab0-261">You must pass the same GUID that is specified in the `solutionId` attribute of the `vstov4:document` element in the application manifest.</span></span> <span data-ttu-id="aeab0-262">有关详细信息，请参阅[Application and Deployment Manifests in Office Solutions](/visualstudio/vsto/application-and-deployment-manifests-in-office-solutions)并[ \&l t; 文档\&g t;元素](/visualstudio/vsto/document-element-office-development-in-visual-studio)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-262">For more information, see [Application and Deployment Manifests in Office Solutions](/visualstudio/vsto/application-and-deployment-manifests-in-office-solutions) and [\&lt;document\&gt; Element](/visualstudio/vsto/document-element-office-development-in-visual-studio).</span></span>  
  
 <span data-ttu-id="aeab0-263">如果附加的自定义项从发布位置，请确保指定正确的程序集的文件名`assemblyName`参数。</span><span class="sxs-lookup"><span data-stu-id="aeab0-263">If you are attaching a customization from a publish location, make sure that you specify the correct file name for the assembly in the `assemblyName` parameter.</span></span> <span data-ttu-id="aeab0-264">当发布 Office 解决方案时，复制到发布文件夹的程序集具有.deploy 文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="aeab0-264">When you publish an Office solution, the assembly that is copied to the publish folder has the .deploy file name extension.</span></span> <span data-ttu-id="aeab0-265">例如，如果程序集名称，WordDocument1.dll publish 文件夹中的程序集的文件名是 WordDocument1.dll.deploy。</span><span class="sxs-lookup"><span data-stu-id="aeab0-265">For example, if the assembly name is WordDocument1.dll, the file name of the assembly in the publish folder is WordDocument1.dll.deploy.</span></span> <span data-ttu-id="aeab0-266">有关详细信息，请参阅[部署 Office 解决方案使用 clickonce](/visualstudio/vsto/deploying-an-office-solution-by-using-clickonce)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-266">For more information, see [Deploying an Office Solution by Using ClickOnce](/visualstudio/vsto/deploying-an-office-solution-by-using-clickonce).</span></span>  
  
 <span data-ttu-id="aeab0-267">如果指定的文档不包含自定义项要求文档，一个控件<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>方法将成功，但该程序集将加载在用户打开文档时失败。</span><span class="sxs-lookup"><span data-stu-id="aeab0-267">If the specified document does not contain a control that the customization expects the document to have, the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method will succeed, but the assembly will fail to load when the user opens the document.</span></span>  
  
 <span data-ttu-id="aeab0-268">`fileType`参数必须指定具有支持的 Microsoft Office Word 和 Microsoft Office Excel 文档级自定义项的文件扩展名的文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-268">The `fileType` parameter must specify a document that has a file name extension that is supported for document-level customizations for Microsoft Office Word and Microsoft Office Excel.</span></span> <span data-ttu-id="aeab0-269">无法将自定义项附加到 Word XML 文档中保存的文档 (\* xml) 或 Word 2003 XML 文档 (\*xml) 文件格式。</span><span class="sxs-lookup"><span data-stu-id="aeab0-269">You cannot attach a customization to a document that is saved in the Word XML Document (\*xml) or Word 2003 XML Document (\*xml) file formats.</span></span> <span data-ttu-id="aeab0-270">有关受支持的文件类型的详细信息，请参阅[Architecture of Document-level Customizations](/visualstudio/vsto/architecture-of-document-level-customizations)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-270">For more information about the supported file types, see [Architecture of Document-Level Customizations](/visualstudio/vsto/architecture-of-document-level-customizations).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-271">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>方法将自定义项附加到指定的文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-271">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method to attach a customization to the specified document.</span></span>  
  
 <span data-ttu-id="aeab0-272">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-272">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-273">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-273">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-274">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-274">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-275">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-275">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-276">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-276">or</span></span>  
  
    -   <span data-ttu-id="aeab0-277">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-277">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
 [!code-csharp[Trin_ServerDocument#7](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#7)]
 [!code-vb[Trin_ServerDocument#7](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="aeab0-278"><paramref name="documentPath" /> 或 <paramref name="assemblyName" /> 为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="aeab0-278"><paramref name="documentPath" /> or <paramref name="assemblyName" /> is <see langword="null" /> or empty.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="aeab0-279"><paramref name="documentPath" /> 或 <paramref name="assemblyName" /> 表示一个不存在的文件。</span><span class="sxs-lookup"><span data-stu-id="aeab0-279"><paramref name="documentPath" /> or <paramref name="assemblyName" /> refers to a file that does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentAlreadyCustomizedException"><span data-ttu-id="aeab0-280"><paramref name="documentPath" /> 指定的文档已具有自定义。</span><span class="sxs-lookup"><span data-stu-id="aeab0-280">The document specified by <paramref name="documentPath" /> already has a customization.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentNotCustomizedException"><span data-ttu-id="aeab0-281"><paramref name="documentPath" /> 指定的文档已损坏，或具有受限权限。</span><span class="sxs-lookup"><span data-stu-id="aeab0-281">The document specified by <paramref name="documentPath" /> is corrupt, or has restricted permissions.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="aeab0-282"><paramref name="documentPath" /> 指定的文档具有不受 [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 支持的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="aeab0-282">The document specified by <paramref name="documentPath" /> has a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="AddCustomization">
      <MemberSignature Language="C#" Value="public static void AddCustomization (string documentPath, string assemblyName, Guid solutionId, Uri deploymentManifestUrl, bool runAsLocal, out string[] nonpublicCachedDataMembers);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void AddCustomization(string documentPath, string assemblyName, valuetype System.Guid solutionId, class System.Uri deploymentManifestUrl, bool runAsLocal, string[] nonpublicCachedDataMembers) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization(System.String,System.String,System.Guid,System.Uri,System.Boolean,System.String[]@)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
        <Parameter Name="assemblyName" Type="System.String" />
        <Parameter Name="solutionId" Type="System.Guid" />
        <Parameter Name="deploymentManifestUrl" Type="System.Uri" />
        <Parameter Name="runAsLocal" Type="System.Boolean" />
        <Parameter Name="nonpublicCachedDataMembers" Type="System.String[]&amp;" RefType="out" />
      </Parameters>
      <Docs>
        <param name="documentPath">To be added.</param>
        <param name="assemblyName">To be added.</param>
        <param name="solutionId">To be added.</param>
        <param name="deploymentManifestUrl">To be added.</param>
        <param name="runAsLocal">To be added.</param>
        <param name="nonpublicCachedDataMembers">To be added.</param>
        <summary>To be added.</summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="CachedData">
      <MemberSignature Language="C#" Value="public Microsoft.VisualStudio.Tools.Applications.CachedData CachedData { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class Microsoft.VisualStudio.Tools.Applications.CachedData CachedData" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.VisualStudio.Tools.Applications.CachedData</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="aeab0-283">获取一个 <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedData" /> 对象，表示文档中包含的缓存数据。</span><span class="sxs-lookup"><span data-stu-id="aeab0-283">Gets a <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedData" /> object that represents the cached data that is contained in the document.</span></span></summary>
        <value><span data-ttu-id="aeab0-284">文档中包含的缓存数据。</span><span class="sxs-lookup"><span data-stu-id="aeab0-284">The cached data that is contained in the document.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-285">在文档中缓存的数据存储在对象的层次结构。</span><span class="sxs-lookup"><span data-stu-id="aeab0-285">The cached data in a document is stored in a hierarchy of objects.</span></span> <span data-ttu-id="aeab0-286"><xref:Microsoft.VisualStudio.Tools.Applications.CachedData>此属性返回的对象是该层次结构中的第一个对象。</span><span class="sxs-lookup"><span data-stu-id="aeab0-286">The <xref:Microsoft.VisualStudio.Tools.Applications.CachedData> object returned by this property is the first object in that hierarchy.</span></span> <span data-ttu-id="aeab0-287">有关详细信息，请参阅[在服务器上的文档中访问数据](/visualstudio/vsto/accessing-data-in-documents-on-the-server)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-287">For more information, see [Accessing Data in Documents on the Server](/visualstudio/vsto/accessing-data-in-documents-on-the-server).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-288">下面的代码示例创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>，然后使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData%2A>属性显示的数据缓存中对象的名称。</span><span class="sxs-lookup"><span data-stu-id="aeab0-288">The following code example creates a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>, and then uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData%2A> property to display the names of the objects in the data cache.</span></span>  
  
 <span data-ttu-id="aeab0-289">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-289">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-290">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-290">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-291">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-291">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-292">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-292">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-293">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-293">or</span></span>  
  
    -   <span data-ttu-id="aeab0-294">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-294">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-295">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-295">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#5](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#5)]
 [!code-vb[Trin_ServerDocument#5](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#5)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="aeab0-296">关闭 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 对象。</span><span class="sxs-lookup"><span data-stu-id="aeab0-296">Closes the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> object.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-297">调用此方法以释放所有资源并关闭<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>。</span><span class="sxs-lookup"><span data-stu-id="aeab0-297">Call this method to release all resources and close the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-298">下面的代码示例创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>，将显示部署清单的 URL，然后使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close%2A>方法关闭<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>。</span><span class="sxs-lookup"><span data-stu-id="aeab0-298">The following code example creates a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>, displays the URL of the deployment manifest, and then uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close%2A> method to close the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>.</span></span>  
  
 <span data-ttu-id="aeab0-299">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-299">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-300">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-300">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-301">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-301">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-302">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-302">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-303">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-303">or</span></span>  
  
    -   <span data-ttu-id="aeab0-304">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-304">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-305">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-305">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#1](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#1)]
 [!code-vb[Trin_ServerDocument#1](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="DeploymentManifestUrl">
      <MemberSignature Language="C#" Value="public Uri DeploymentManifestUrl { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Uri DeploymentManifestUrl" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualStudio.Tools.Applications.ServerDocument.DeploymentManifestUrl" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Uri</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="aeab0-306">获取或设置与文档关联的自定义项的部署清单 URL。</span><span class="sxs-lookup"><span data-stu-id="aeab0-306">Gets or sets the URL of the deployment manifest for the customization that is associated with the document.</span></span></summary>
        <value><span data-ttu-id="aeab0-307">一个 URL，指定与文档关联的自定义项的部署清单的名称和位置。</span><span class="sxs-lookup"><span data-stu-id="aeab0-307">A URL that specifies the name and location of the deployment manifest for the customization that is associated with the document.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-308">如果将部署清单自定义项移动到另一个位置，并且你想要查找从新位置的自定义项更新的文档，请将此属性设置为新的 URL。</span><span class="sxs-lookup"><span data-stu-id="aeab0-308">Set this property to a new URL if you move the deployment manifest for a customization to a different location, and you want the document to locate customization updates from the new location.</span></span> <span data-ttu-id="aeab0-309">如果设置此属性，该 URL 必须指向已与文档相关联的自定义项的部署清单。</span><span class="sxs-lookup"><span data-stu-id="aeab0-309">If you set this property, the URL must point to a deployment manifest for the customization that is already associated with the document.</span></span>  
  
 <span data-ttu-id="aeab0-310">此属性不能用于将新的自定义与文档相关联。</span><span class="sxs-lookup"><span data-stu-id="aeab0-310">You cannot use this property to associate a new customization with a document.</span></span> <span data-ttu-id="aeab0-311">若要将自定义项添加到自定义的文档，请使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="aeab0-311">To add a customization to an uncustomized document, use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method.</span></span> <span data-ttu-id="aeab0-312">若要将不同的自定义添加到自定义文档，首先使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization%2A>方法来删除当前自定义项，然后使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="aeab0-312">To add a different customization to a customized document, first use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization%2A> method to remove the current customization, and then use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.AddCustomization%2A> method.</span></span>  
  
## <a name="getting-the-url-in-applications-that-target-the-net-framework-35"></a><span data-ttu-id="aeab0-313">在.NET Framework 3.5 为目标的应用程序中获取 URL</span><span class="sxs-lookup"><span data-stu-id="aeab0-313">Getting the URL in Applications that Target the .NET Framework 3.5</span></span>  
 <span data-ttu-id="aeab0-314">当你使用`ServerDocument`Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 程序集中的应用程序面向.NET Framework 3.5 中的类<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.DeploymentManifestUrl%2A>属性返回当前部署清单 URL 仅如果在运行该应用程序的计算机上安装了文档级自定义项。</span><span class="sxs-lookup"><span data-stu-id="aeab0-314">When you use the `ServerDocument` class in the Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll assembly in an application that targets the .NET Framework 3.5, the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.DeploymentManifestUrl%2A> property returns the current deployment manifest URL only if the documentation-level customization is installed on the computer where you are running the application.</span></span> <span data-ttu-id="aeab0-315">对于其他类型的单元格，此属性返回 `null`。</span><span class="sxs-lookup"><span data-stu-id="aeab0-315">Otherwise, this property returns `null`.</span></span>  
  
 <span data-ttu-id="aeab0-316">如果你需要获取您运行的计算机未安装的文档级自定义项的部署清单 URL （例如，如果发布的文档级自定义项的服务器） 上的该应用程序面向.NET Framework 4 中应用程序中，引用 Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 程序集，并使用`ServerDocument`中该程序集的类。</span><span class="sxs-lookup"><span data-stu-id="aeab0-316">If you need to get the deployment manifest URL of a document-level customization that is not installed on the computer where you are running the application (for example, on a server where a document-level customization is published), target the .NET Framework 4 in the application, reference the Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll assembly, and use the `ServerDocument` class in that assembly.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-317">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%29>构造函数创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>加载指定的文档。</span><span class="sxs-lookup"><span data-stu-id="aeab0-317">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.String%29> constructor to create a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> that loads a specified document.</span></span> <span data-ttu-id="aeab0-318">该示例然后显示附加到文档的自定义项的部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="aeab0-318">The example then displays the URL of the deployment manifest for the customization that is attached to the document.</span></span>  
  
 <span data-ttu-id="aeab0-319">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-319">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-320">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-320">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-321">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-321">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-322">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-322">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-323">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-323">or</span></span>  
  
    -   <span data-ttu-id="aeab0-324">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-324">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-325">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-325">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#1](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#1)]
 [!code-vb[Trin_ServerDocument#1](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Document">
      <MemberSignature Language="C#" Value="public byte[] Document { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance unsigned int8[] Document" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Byte[]</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="aeab0-326">获取加载到 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 中的内存中文档的字节数组。</span><span class="sxs-lookup"><span data-stu-id="aeab0-326">Gets the byte array of an in-memory document that is loaded into the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" />.</span></span></summary>
        <value><span data-ttu-id="aeab0-327">加载到 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 中的内存中文档的字节数组。</span><span class="sxs-lookup"><span data-stu-id="aeab0-327">The byte array of an in-memory document that is loaded into the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-328">如果此属性返回已填充的字节数组<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>已通过使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.Byte%5B%5D%2CSystem.String%29>具有一个字节数组参数的构造函数或<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.IO.Stream%2CSystem.String%29>构造函数具有<xref:System.IO.Stream>参数。</span><span class="sxs-lookup"><span data-stu-id="aeab0-328">This property returns a filled byte array if the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> was created by using the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.Byte%5B%5D%2CSystem.String%29> constructor that has a byte array parameter, or the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.IO.Stream%2CSystem.String%29> constructor that has a <xref:System.IO.Stream> parameter.</span></span> <span data-ttu-id="aeab0-329">否则，此属性返回一个空字节数组。</span><span class="sxs-lookup"><span data-stu-id="aeab0-329">Otherwise, this property returns an empty byte array.</span></span>  
  
 <span data-ttu-id="aeab0-330">使用此属性，可对文档进行更改并将其发送到客户端，而无需将文档写入磁盘。</span><span class="sxs-lookup"><span data-stu-id="aeab0-330">Using this property enables you to make changes to a document and send it to a client without writing the document to disk.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-331">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.Byte%5B%5D%2CSystem.String%29>构造函数创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>从字节数组，其中包含文件扩展名为.xlsx 的 Excel 工作簿。</span><span class="sxs-lookup"><span data-stu-id="aeab0-331">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.%23ctor%28System.Byte%5B%5D%2CSystem.String%29> constructor to create a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> from a byte array that contains an Excel workbook with the .xlsx file name extension.</span></span> <span data-ttu-id="aeab0-332">该示例然后使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A>属性显示在文档中的字节数。</span><span class="sxs-lookup"><span data-stu-id="aeab0-332">The example then uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Document%2A> property to display the number of bytes in the document.</span></span>  
  
 <span data-ttu-id="aeab0-333">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-333">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-334">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-334">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-335">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-335">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-336">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-336">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-337">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-337">or</span></span>  
  
    -   <span data-ttu-id="aeab0-338">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-338">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-339">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-339">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#2](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#2)]
 [!code-vb[Trin_ServerDocument#2](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentClosedException"><span data-ttu-id="aeab0-340">文档已关闭。</span><span class="sxs-lookup"><span data-stu-id="aeab0-340">The document has been closed.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Finalize">
      <MemberSignature Language="C#" Value="~ServerDocument ();" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Finalize() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Finalize" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>To be added.</summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="GetCustomizationVersion">
      <MemberSignature Language="C#" Value="public static int GetCustomizationVersion (string documentPath);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 GetCustomizationVersion(string documentPath) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion(System.String)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="aeab0-341">要检查的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="aeab0-341">The full path of the document that you want to check.</span></span></param>
        <summary><span data-ttu-id="aeab0-342">返回用于创建与指定文档相关联的自定义项的 [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 的版本。</span><span class="sxs-lookup"><span data-stu-id="aeab0-342">Returns the version of the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] that was used to create the customization that is associated with the specified document.</span></span></summary>
        <returns><span data-ttu-id="aeab0-343">一个编号，指定用于创建关联的自定义项的 [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 版本。</span><span class="sxs-lookup"><span data-stu-id="aeab0-343">A number that specifies the version of the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] that was used to create the associated customization.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-344">不同版本的 Visual Studio 中创建 office 解决方案使用不同版本的[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="aeab0-344">Office solutions created in different versions of Visual Studio use different versions of the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span> <span data-ttu-id="aeab0-345">每个版本的运行时提供的不同版本`ServerDocument`旨在使用针对该版本的运行时的解决方案的类。</span><span class="sxs-lookup"><span data-stu-id="aeab0-345">Each version of the runtime provides a different version of the `ServerDocument` class that is designed to work with solutions for that version of the runtime.</span></span> <span data-ttu-id="aeab0-346">此版本的<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>类可用于通过使用创建的解决方案[!INCLUDE[vs_dev12](~/includes/vs-dev12-md.md)]，[!INCLUDE[vs_dev10_long](~/includes/vs-dev10-long-md.md)]和 2007 Microsoft Office 创建的解决方案，通过使用 Visual Studio 2008。</span><span class="sxs-lookup"><span data-stu-id="aeab0-346">This version of the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> class can be used with solutions that are created by using [!INCLUDE[vs_dev12](~/includes/vs-dev12-md.md)], [!INCLUDE[vs_dev10_long](~/includes/vs-dev10-long-md.md)] and with 2007 Microsoft Office solutions that are created by using Visual Studio 2008.</span></span>  
  
 <span data-ttu-id="aeab0-347">下表指定了此方法的返回值的含义。</span><span class="sxs-lookup"><span data-stu-id="aeab0-347">The following table specifies the meaning of the return values for this method.</span></span>  
  
|<span data-ttu-id="aeab0-348">返回值</span><span class="sxs-lookup"><span data-stu-id="aeab0-348">Return value</span></span>|<span data-ttu-id="aeab0-349">描述</span><span class="sxs-lookup"><span data-stu-id="aeab0-349">Description</span></span>|  
|------------------|-----------------|  
|<span data-ttu-id="aeab0-350">0</span><span class="sxs-lookup"><span data-stu-id="aeab0-350">0</span></span>|<span data-ttu-id="aeab0-351">文档不具有自定义项。</span><span class="sxs-lookup"><span data-stu-id="aeab0-351">The document does not have a customization.</span></span>|  
|<span data-ttu-id="aeab0-352">1</span><span class="sxs-lookup"><span data-stu-id="aeab0-352">1</span></span>|<span data-ttu-id="aeab0-353">文档具有使用 Visual Studio Tools for Office 2003 版</span><span class="sxs-lookup"><span data-stu-id="aeab0-353">The document has a customization that was created by using Visual Studio Tools for Office, Version 2003.</span></span>|  
|<span data-ttu-id="aeab0-354">2</span><span class="sxs-lookup"><span data-stu-id="aeab0-354">2</span></span>|<span data-ttu-id="aeab0-355">文档具有使用 Visual Studio 2005 Tools for Office Second Edition 运行时</span><span class="sxs-lookup"><span data-stu-id="aeab0-355">The document has a customization that was created by using the Visual Studio 2005 Tools for Office Second Edition runtime.</span></span> <span data-ttu-id="aeab0-356">这是运行时使用的自定义项 Microsoft Office 2003 中 Visual Studio 2005 Tools for Office 和 Visual Studio 2008 的版本。</span><span class="sxs-lookup"><span data-stu-id="aeab0-356">This is the version of the runtime that is used by customizations for Microsoft Office 2003 in Visual Studio 2005 Tools for Office and Visual Studio 2008.</span></span>|  
|<span data-ttu-id="aeab0-357">3</span><span class="sxs-lookup"><span data-stu-id="aeab0-357">3</span></span>|<span data-ttu-id="aeab0-358">该文档具有已通过使用 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office system 的自定义项 (版本 3.0 运行时)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-358">The document has a customization that was created by using the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span> <span data-ttu-id="aeab0-359">自定义 2007 Microsoft Office system 在 Visual Studio 2008 中使用的运行时版本 3.0。</span><span class="sxs-lookup"><span data-stu-id="aeab0-359">Version 3.0 of the runtime is used by customizations for the 2007 Microsoft Office system in Visual Studio 2008.</span></span>|  
  
 <span data-ttu-id="aeab0-360">有关不同版本的详细信息[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)]，请参阅[Visual Studio Tools for Office Runtime 概述](/visualstudio/vsto/visual-studio-tools-for-office-runtime-overview)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-360">For more information about the different versions of the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)], see [Visual Studio Tools for Office Runtime Overview](/visualstudio/vsto/visual-studio-tools-for-office-runtime-overview).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-361">下面的代码示例创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>的加载指定的文档，然后显示附加到文档的自定义项的部署清单的 URL。</span><span class="sxs-lookup"><span data-stu-id="aeab0-361">The following code example creates a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> that loads a specified document and then displays the URL of the deployment manifest for the customization that is attached to the document.</span></span> <span data-ttu-id="aeab0-362">在创建对象时之前, 的代码使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A>方法以验证自定义项，通过使用 Visual Studio 2010 Tools for Office 运行时创建。</span><span class="sxs-lookup"><span data-stu-id="aeab0-362">Before creating the object, the code uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A> method to verify that the customization was created by using the Visual Studio 2010 Tools for Office Runtime.</span></span>  
  
 <span data-ttu-id="aeab0-363">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-363">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-364">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-364">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-365">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-365">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-366">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-366">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-367">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-367">or</span></span>  
  
    -   <span data-ttu-id="aeab0-368">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-368">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-369">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-369">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#1](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#1)]
 [!code-vb[Trin_ServerDocument#1](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="aeab0-370"><paramref name="documentPath" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="aeab0-370">The <paramref name="documentPath" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="aeab0-371"><paramref name="documentPath" /> 指定的文件不存在。</span><span class="sxs-lookup"><span data-stu-id="aeab0-371">The file specified by <paramref name="documentPath" /> does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.UnknownCustomizationFileException"><span data-ttu-id="aeab0-372">[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 不支持 <paramref name="documentPath" /> 指定的文件的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="aeab0-372">The file specified by <paramref name="documentPath" /> has a file name extension that is not supported by the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)].</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="IsCacheEnabled">
      <MemberSignature Language="C#" Value="public static bool IsCacheEnabled (string documentPath);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool IsCacheEnabled(string documentPath) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.IsCacheEnabled(System.String)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="aeab0-373">要检查的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="aeab0-373">The full path of the document that you want to check.</span></span></param>
        <summary><span data-ttu-id="aeab0-374">获取一个值，该值指示指定文档是否具有数据缓存。</span><span class="sxs-lookup"><span data-stu-id="aeab0-374">Gets a value that indicates whether the specified document has a data cache.</span></span></summary>
        <returns><span data-ttu-id="aeab0-375">如果指定文档具有数据缓存，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="aeab0-375"><see langword="true" /> if the specified document has a data cache; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-376">此方法不是数据缓存实际包含数据仅指示文档是否具有数据缓存的。</span><span class="sxs-lookup"><span data-stu-id="aeab0-376">This method indicates only whether the document has a data cache, not whether the data cache actually contains data.</span></span> <span data-ttu-id="aeab0-377">如果文档具有数据缓存，但不包含在其中任何数据，此方法仍返回`true`。</span><span class="sxs-lookup"><span data-stu-id="aeab0-377">If the document has a data cache that contains no data in it, this method still returns `true`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-378">下面的代码示例创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>，然后使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData%2A>属性来显示数据缓存的内容。</span><span class="sxs-lookup"><span data-stu-id="aeab0-378">The following code example creates a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>, and then uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.CachedData%2A> property to display the contents of the data cache.</span></span> <span data-ttu-id="aeab0-379">该示例首先使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.IsCacheEnabled%2A>方法以验证该工作簿具有数据缓存。</span><span class="sxs-lookup"><span data-stu-id="aeab0-379">The example first uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.IsCacheEnabled%2A> method to verify that the workbook has a data cache.</span></span>  
  
 <span data-ttu-id="aeab0-380">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-380">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-381">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-381">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-382">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-382">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-383">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-383">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-384">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-384">or</span></span>  
  
    -   <span data-ttu-id="aeab0-385">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-385">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-386">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-386">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#5](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#5)]
 [!code-vb[Trin_ServerDocument#5](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="aeab0-387"><paramref name="documentPath" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="aeab0-387">The <paramref name="documentPath" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="aeab0-388"><paramref name="documentPath" /> 指定的文件不存在。</span><span class="sxs-lookup"><span data-stu-id="aeab0-388">The file specified by <paramref name="documentPath" /> does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="aeab0-389"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="aeab0-389">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="IsCustomized">
      <MemberSignature Language="C#" Value="public static bool IsCustomized (string documentPath);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool IsCustomized(string documentPath) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.IsCustomized(System.String)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="aeab0-390">要检查自定义项的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="aeab0-390">The full path of the document that you want to check for a customization.</span></span></param>
        <summary><span data-ttu-id="aeab0-391">获取指示指定的文档是否具有用 Visual Studio 2010 Tools for Office Runtime 创建的自定义的值。</span><span class="sxs-lookup"><span data-stu-id="aeab0-391">Gets a value that indicates whether the specified document has a customization that was created by using the Visual Studio 2010 Tools for Office Runtime.</span></span></summary>
        <returns><span data-ttu-id="aeab0-392">如果文档具有使用 Visual Studio 2010 Tools for Office Runtime 生产的自定义，则为 <see langword="true" />；如果文档不具有自定义，则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="aeab0-392"><see langword="true" /> if the document has a customization that was created by using the Visual Studio 2010 Tools for Office Runtime; <see langword="false" /> if the document does not have a customization.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-393">此方法将引发异常，如果指定的文档的自定义的项不是创建与 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office system (3.0 版运行时)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-393">This method throws an exception if the specified document has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span> <span data-ttu-id="aeab0-394">例如，此方法引发异常，如果指定的文档，因为这些项目模板使用 Visual Studio 2005 Tools for Office Second Edition 运行时通过在 Visual Studio 2008 中，Microsoft Office 2003 项目模板创建。</span><span class="sxs-lookup"><span data-stu-id="aeab0-394">For example, this method throws an exception if you specify a document that was created by using a project template for Microsoft Office 2003 in Visual Studio 2008, because these project templates use the Visual Studio 2005 Tools for Office Second Edition runtime.</span></span>  
  
 <span data-ttu-id="aeab0-395">若要确定文档是否具有已通过使用任何版本的 Visual Studio 的自定义项，请使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A>方法而不是<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.IsCustomized%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="aeab0-395">To determine whether a document has a customization that was created by using any version of Visual Studio, use the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A> method instead of the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.IsCustomized%2A> method.</span></span> <span data-ttu-id="aeab0-396"><xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A> 如果文档不具有自定义项，则返回 0 （零）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-396"><xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A> returns 0 (zero) if the document does not have a customization.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="aeab0-397"><paramref name="documentPath" /> 参数为 <see langword="null" /> 或为空，或者完全由空白字符组成。</span><span class="sxs-lookup"><span data-stu-id="aeab0-397">The <paramref name="documentPath" /> parameter is <see langword="null" /> or empty or consists entirely of white space characters.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="aeab0-398"><paramref name="documentPath" /> 中的文件不存在。</span><span class="sxs-lookup"><span data-stu-id="aeab0-398">The file in <paramref name="documentPath" /> does not exist.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="aeab0-399"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="aeab0-399">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="RemoveCustomization">
      <MemberSignature Language="C#" Value="public static void RemoveCustomization (string documentPath);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void RemoveCustomization(string documentPath) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization(System.String)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="documentPath" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="documentPath"><span data-ttu-id="aeab0-400">要移除自定义的文档的完整路径。</span><span class="sxs-lookup"><span data-stu-id="aeab0-400">The full path of the document from which you want to remove the customization.</span></span></param>
        <summary><span data-ttu-id="aeab0-401">从文档移除自定义。</span><span class="sxs-lookup"><span data-stu-id="aeab0-401">Removes the customization from the document.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-402">此方法将清除部署清单 URL 和缓存的数据清单中，并从文档中删除任何缓存的数据。</span><span class="sxs-lookup"><span data-stu-id="aeab0-402">This method clears the deployment manifest URL and the cached data manifest, and removes any cached data from the document.</span></span> <span data-ttu-id="aeab0-403">有关详细信息，请参阅[如何： 从文档中删除托管代码扩展](/visualstudio/vsto/how-to-remove-managed-code-extensions-from-documents)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-403">For more information, see [How to: Remove Managed Code Extensions from Documents](/visualstudio/vsto/how-to-remove-managed-code-extensions-from-documents).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-404">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization%2A>方法从指定的文档中删除自定义项。</span><span class="sxs-lookup"><span data-stu-id="aeab0-404">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.RemoveCustomization%2A> method to remove the customization from the specified document.</span></span> <span data-ttu-id="aeab0-405">此示例的第一个调用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A>方法来确定文档是否具有自定义项。</span><span class="sxs-lookup"><span data-stu-id="aeab0-405">The example first calls the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.GetCustomizationVersion%2A> method to determine whether the document has a customization.</span></span>  
  
 <span data-ttu-id="aeab0-406">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-406">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-407">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-407">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-408">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-408">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-409">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-409">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-410">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-410">or</span></span>  
  
    -   <span data-ttu-id="aeab0-411">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-411">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-412">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-412">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#8](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#8)]
 [!code-vb[Trin_ServerDocument#8](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="aeab0-413"><paramref name="documentPath" /> 参数为 <see langword="null" /> 或为空，或者完全由空格字符组成。</span><span class="sxs-lookup"><span data-stu-id="aeab0-413">The <paramref name="documentPath" /> parameter is <see langword="null" /> or empty or consists completely of white space characters.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="aeab0-414"><paramref name="documentPath" /> 指定的文件不存在。</span><span class="sxs-lookup"><span data-stu-id="aeab0-414">The file specified by <paramref name="documentPath" /> does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="aeab0-415"><paramref name="documentPath" /> 指定的文件为只读或无法访问。</span><span class="sxs-lookup"><span data-stu-id="aeab0-415">The file specified by <paramref name="documentPath" /> is read-only, or cannot be accessed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="aeab0-416"><paramref name="documentPath" /> 指定的文件不具有自定义，或加载清单时发生错误。</span><span class="sxs-lookup"><span data-stu-id="aeab0-416">The file specified by <paramref name="documentPath" /> does not have a customization, or an error occurred while loading the manifest.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentCustomizedWithPreviousRuntimeException"><span data-ttu-id="aeab0-417"><paramref name="documentPath" /> 指定的文件具有并非通过 Visual Studio 2010 Tools for Office Runtime 或 Visual Studio Tools for Microsoft Office System（3.0 版 Runtime）创建的自定义。</span><span class="sxs-lookup"><span data-stu-id="aeab0-417">The file specified by <paramref name="documentPath" /> has a customization that was not created with the Visual Studio 2010 Tools for Office Runtime or the Visual Studio Tools for the Microsoft Office system (version 3.0 Runtime).</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Save">
      <MemberSignature Language="C#" Value="public void Save ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Save() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Save" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="aeab0-418">保存使用 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 类对文档所做的任何更改。</span><span class="sxs-lookup"><span data-stu-id="aeab0-418">Saves any changes that were made to the document by using the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-419"><xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Save%2A>方法将保存或到部署清单 URL 在文档中缓存数据所做的任何更改。</span><span class="sxs-lookup"><span data-stu-id="aeab0-419">The <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Save%2A> method saves any changes you have made to the cached data or to the deployment manifest URL in the document.</span></span> <span data-ttu-id="aeab0-420">如果您创建<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>对象使用的文档在磁盘上，此方法将这些更改保存到磁盘。</span><span class="sxs-lookup"><span data-stu-id="aeab0-420">If you created the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> object by using a document on disk, this method saves these changes to disk.</span></span> <span data-ttu-id="aeab0-421">如果您创建<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>对象使用的文档在内存中，此方法将这些更改保存到内存缓冲区。</span><span class="sxs-lookup"><span data-stu-id="aeab0-421">If you created the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> object by using a document in memory, this method saves these changes to the memory buffer.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="aeab0-422">下面的代码示例创建一个新<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>为指定的 Excel 工作簿，修改通过使用缓存的工作表中的字符串的值<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A>方法，然后将更改保存使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Save%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="aeab0-422">The following code example creates a new <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> for a specified Excel workbook, modifies the value of a string that is cached in a worksheet by using the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A> method, and then saves the change by using the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Save%2A> method.</span></span>  
  
 <span data-ttu-id="aeab0-423">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="aeab0-423">This example requires:</span></span>  
  
-   <span data-ttu-id="aeab0-424">具有的 Excel 文档级自定义`Sheet1`类中`ExcelWorkbook1`命名空间，并在已缓存的字符串`Sheet1`类名为`CachedString`。</span><span class="sxs-lookup"><span data-stu-id="aeab0-424">A document-level customization for Excel that has a `Sheet1` class in the `ExcelWorkbook1` namespace, and a cached string in the `Sheet1` class named `CachedString`.</span></span>  
  
-   <span data-ttu-id="aeab0-425">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="aeab0-425">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="aeab0-426">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="aeab0-426">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="aeab0-427">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.dll (如果项目面向 [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] 或 [!INCLUDE[net_v45](~/includes/net-v45-md.md)])。</span><span class="sxs-lookup"><span data-stu-id="aeab0-427">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.dll (if the project targets the [!INCLUDE[net_v40_short](~/includes/net-v40-short-md.md)] or the [!INCLUDE[net_v45](~/includes/net-v45-md.md)]).</span></span>  
  
         <span data-ttu-id="aeab0-428">或</span><span class="sxs-lookup"><span data-stu-id="aeab0-428">or</span></span>  
  
    -   <span data-ttu-id="aeab0-429">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll 和 Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll （如果项目面向.NET Framework 3.5）。</span><span class="sxs-lookup"><span data-stu-id="aeab0-429">Microsoft.VisualStudio.Tools.Applications.ServerDocument.v10.0.dll and Microsoft.VisualStudio.Tools.Applications.Runtime.v9.0.dll (if the project targets the .NET Framework 3.5).</span></span>  
  
-   <span data-ttu-id="aeab0-430">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="aeab0-430">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#9](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#9)]
 [!code-vb[Trin_ServerDocument#9](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.DocumentClosedException"><span data-ttu-id="aeab0-431"><see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 已关闭。</span><span class="sxs-lookup"><span data-stu-id="aeab0-431">The <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> has been closed.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.MissingHostItemIdException"><span data-ttu-id="aeab0-432"><see cref="P:Microsoft.VisualStudio.Tools.Applications.CachedDataHostItem.Id" /> 的 <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataHostItem" /> 属性为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="aeab0-432">The <see cref="P:Microsoft.VisualStudio.Tools.Applications.CachedDataHostItem.Id" /> property of a <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataHostItem" /> is <see langword="null" /> or empty.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.MissingDataIdException"><span data-ttu-id="aeab0-433"><see cref="P:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Id" /> 的 <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" /> 属性为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="aeab0-433">The <see cref="P:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Id" /> property of a <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" /> is <see langword="null" /> or empty.</span></span></exception>
        <exception cref="T:Microsoft.VisualStudio.Tools.Applications.Runtime.MissingTypeException"><span data-ttu-id="aeab0-434"><see cref="P:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.DataType" /> 的 <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" /> 属性为 <see langword="null" /> 或为空。</span><span class="sxs-lookup"><span data-stu-id="aeab0-434">The <see cref="P:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.DataType" /> property of a <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" /> is <see langword="null" /> or empty.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="SolutionId">
      <MemberSignature Language="C#" Value="public Guid SolutionId { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid SolutionId" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualStudio.Tools.Applications.ServerDocument.SolutionId" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="aeab0-435">获取一个 GUID，[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 可用其标识解决方案。</span><span class="sxs-lookup"><span data-stu-id="aeab0-435">Gets a GUID that the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] uses to identify the solution.</span></span></summary>
        <value><span data-ttu-id="aeab0-436">一个 GUID，[!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] 可用其标识解决方案。</span><span class="sxs-lookup"><span data-stu-id="aeab0-436">A GUID that the [!INCLUDE[vsto_runtime](~/includes/vsto-runtime-md.md)] uses to identify the solution.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-437">值<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.SolutionId%2A>属性是在中指定的相同 GUID`solutionId`属性的`vstov4:document`解决方案的应用程序清单中的元素。</span><span class="sxs-lookup"><span data-stu-id="aeab0-437">The value of the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.SolutionId%2A> property is the same GUID that is specified in the `solutionId` attribute of the `vstov4:document` element in the application manifest for the solution.</span></span> <span data-ttu-id="aeab0-438">有关详细信息，请参阅[Application and Deployment Manifests in Office Solutions](/visualstudio/vsto/application-and-deployment-manifests-in-office-solutions)并[ \&l t; 文档\&g t;元素](/visualstudio/vsto/document-element-office-development-in-visual-studio)。</span><span class="sxs-lookup"><span data-stu-id="aeab0-438">For more information, see [Application and Deployment Manifests in Office Solutions](/visualstudio/vsto/application-and-deployment-manifests-in-office-solutions) and [\&lt;document\&gt; Element](/visualstudio/vsto/document-element-office-development-in-visual-studio).</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="System.IDisposable.Dispose">
      <MemberSignature Language="C#" Value="void IDisposable.Dispose ();" />
      <MemberSignature Language="ILAsm" Value=".method hidebysig newslot virtual instance void System.IDisposable.Dispose() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.ServerDocument.System#IDisposable#Dispose" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="aeab0-439">释放由 <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" /> 使用的所有资源。</span><span class="sxs-lookup"><span data-stu-id="aeab0-439">Releases all resources used by the <see cref="T:Microsoft.VisualStudio.Tools.Applications.ServerDocument" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="aeab0-440">不要调用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.System%23IDisposable%23Dispose%2A>直接在您自己的代码中的方法。</span><span class="sxs-lookup"><span data-stu-id="aeab0-440">Do not call the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.System%23IDisposable%23Dispose%2A> method directly in your own code.</span></span> <span data-ttu-id="aeab0-441">完成后使用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>，调用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close%2A>方法相反。</span><span class="sxs-lookup"><span data-stu-id="aeab0-441">When you are finished using the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument>, call the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close%2A> method instead.</span></span> <span data-ttu-id="aeab0-442"><xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.System%23IDisposable%23Dispose%2A> 在调用时将自动调用<xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="aeab0-442"><xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.System%23IDisposable%23Dispose%2A> is called automatically when you call the <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument.Close%2A> method.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>