<Type Name="CachedDataItem" FullName="Microsoft.VisualStudio.Tools.Applications.CachedDataItem">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="366909909d65e8b755522de5f3ee3a8bc57e5cd2" />
    <Meta Name="ms.sourcegitcommit" Value="66ccc1ab172558cdfd2b9ffb616a60e4c9105be3" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-CN" />
    <Meta Name="ms.lasthandoff" Value="09/19/2018" />
    <Meta Name="ms.locfileid" Value="46458894" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class CachedDataItem : Microsoft.VisualStudio.Tools.Applications.CachedDataNodeBase" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit CachedDataItem extends Microsoft.VisualStudio.Tools.Applications.CachedDataNodeBase" />
  <TypeSignature Language="DocId" Value="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" />
  <AssemblyInfo>
    <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
    <AssemblyVersion>10.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>Microsoft.VisualStudio.Tools.Applications.CachedDataNodeBase</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>
      <span data-ttu-id="2fe08-101">表示文档级自定义中的缓存数据对象，该文档级自定义通过使用 Visual Studio 中的 Office 开发工具创建。</span>
      <span class="sxs-lookup">
        <span data-stu-id="2fe08-101">Represents a cached data object in a document-level customization that was created by using the Office development tools in Visual Studio.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2fe08-102">有关在文档级自定义项中缓存数据的详细信息，请参阅[缓存数据](/visualstudio/vsto/caching-data)并[访问服务器上的文档中的数据](/visualstudio/vsto/accessing-data-in-documents-on-the-server)。</span><span class="sxs-lookup"><span data-stu-id="2fe08-102">For more information about caching data in document-level customizations, see [Caching Data](/visualstudio/vsto/caching-data) and [Accessing Data in Documents on the Server](/visualstudio/vsto/accessing-data-in-documents-on-the-server).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2fe08-103">下面的代码示例检查每个<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem>Excel 工作簿，并显示的数据缓存中的每个名称缓存数据对象。</span><span class="sxs-lookup"><span data-stu-id="2fe08-103">The following code example examines each <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem> in the data cache of an Excel workbook and displays the name of each cached data object.</span></span>  
  
 <span data-ttu-id="2fe08-104">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="2fe08-104">This example requires:</span></span>  
  
-   <span data-ttu-id="2fe08-105">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="2fe08-105">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="2fe08-106">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="2fe08-106">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="2fe08-107">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll</span><span class="sxs-lookup"><span data-stu-id="2fe08-107">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll</span></span>  
  
    -   <span data-ttu-id="2fe08-108">Microsoft.VisualStudio.Tools.Applications.Runtime.dll</span><span class="sxs-lookup"><span data-stu-id="2fe08-108">Microsoft.VisualStudio.Tools.Applications.Runtime.dll</span></span>  
  
-   <span data-ttu-id="2fe08-109">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="2fe08-109">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#5](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#5)]
 [!code-vb[Trin_ServerDocument#5](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#5)]  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <Member MemberName="DataType">
      <MemberSignature Language="C#" Value="public string DataType { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string DataType" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.DataType" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="2fe08-110">获取或设置缓存数据对象类型的程序集限定名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2fe08-110">Gets or sets the assembly-qualified name of the type of the cached data object.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="2fe08-111">缓存的数据对象的类型的程序集限定名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2fe08-111">The assembly-qualified name of the type of the cached data object.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2fe08-112"><xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.DataType%2A>属性返回的是有用的创建自定义类型的新实例的数据缓存中的缓存的数据类型的程序集限定名称。</span><span class="sxs-lookup"><span data-stu-id="2fe08-112">The <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.DataType%2A> property returns an assembly-qualified name of the cached data type that is useful for creating a new instance of a custom type that is in the data cache.</span></span> <span data-ttu-id="2fe08-113">例如，可以获取<xref:System.Type>并传递到程序集限定类型名称的自定义数据类型的<xref:System.Type.GetType%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="2fe08-113">For example, you can get the <xref:System.Type> of a custom data type by passing the assembly-qualified type name to the <xref:System.Type.GetType%2A> method.</span></span> <span data-ttu-id="2fe08-114">然后可以通过传递此创建自定义类型的实例<xref:System.Type>作为参数<xref:System.Activator.CreateInstance%2A?displayProperty=fullName>方法。</span><span class="sxs-lookup"><span data-stu-id="2fe08-114">You can then create an instance of the custom type by passing this <xref:System.Type> as a parameter to the <xref:System.Activator.CreateInstance%2A?displayProperty=fullName> method.</span></span>  
  
 <span data-ttu-id="2fe08-115">返回的程序集限定类型字符串的格式有关的详细信息<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.DataType%2A>属性，请参阅<xref:System.Type.AssemblyQualifiedName%2A?displayProperty=fullName>属性。</span><span class="sxs-lookup"><span data-stu-id="2fe08-115">For details about the format of the assembly-qualified type string that is returned by the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.DataType%2A> property, see the <xref:System.Type.AssemblyQualifiedName%2A?displayProperty=fullName> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2fe08-116">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A>方法来修改 Excel 工作簿的工作表中缓存的字符串的值。</span><span class="sxs-lookup"><span data-stu-id="2fe08-116">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A> method to modify the value of a string that is cached in a worksheet of an Excel workbook.</span></span> <span data-ttu-id="2fe08-117">该代码使用<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.DataType%2A>属性以验证缓存的数据对象，尝试对其进行修改之前是一个字符串。</span><span class="sxs-lookup"><span data-stu-id="2fe08-117">The code uses the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.DataType%2A> property to verify that the cached data object is a string before trying to modify it.</span></span>  
  
 <span data-ttu-id="2fe08-118">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="2fe08-118">This example requires:</span></span>  
  
-   <span data-ttu-id="2fe08-119">具有的 Excel 文档级自定义`Sheet1`类中`ExcelWorkbook1`命名空间，并在已缓存的字符串`Sheet1`类名为`CachedString`。</span><span class="sxs-lookup"><span data-stu-id="2fe08-119">A document-level customization for Excel that has a `Sheet1` class in the `ExcelWorkbook1` namespace, and a cached string in the `Sheet1` class named `CachedString`.</span></span>  
  
-   <span data-ttu-id="2fe08-120">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="2fe08-120">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="2fe08-121">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="2fe08-121">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="2fe08-122">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll</span><span class="sxs-lookup"><span data-stu-id="2fe08-122">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll</span></span>  
  
    -   <span data-ttu-id="2fe08-123">Microsoft.VisualStudio.Tools.Applications.Runtime.dll</span><span class="sxs-lookup"><span data-stu-id="2fe08-123">Microsoft.VisualStudio.Tools.Applications.Runtime.dll</span></span>  
  
-   <span data-ttu-id="2fe08-124">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="2fe08-124">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#9](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#9)]
 [!code-vb[Trin_ServerDocument#9](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#9)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Id">
      <MemberSignature Language="C#" Value="public string Id { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Id" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Id" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="2fe08-125">获取或设置通过 <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" /> 表示的缓存数据对象的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2fe08-125">Gets or sets the name of the cached data object that is represented by the <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" />.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="2fe08-126">由表示的缓存的数据对象的名称<see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataHostItem" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2fe08-126">The name of the cached data object that is represented by the <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataHostItem" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="2fe08-127">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Id%2A>属性来显示 Excel 工作簿中缓存的数据对象的名称。</span><span class="sxs-lookup"><span data-stu-id="2fe08-127">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Id%2A> property to display the names of the cached data objects in an Excel workbook.</span></span>  
  
 <span data-ttu-id="2fe08-128">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="2fe08-128">This example requires:</span></span>  
  
-   <span data-ttu-id="2fe08-129">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="2fe08-129">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="2fe08-130">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="2fe08-130">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="2fe08-131">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll</span><span class="sxs-lookup"><span data-stu-id="2fe08-131">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll</span></span>  
  
    -   <span data-ttu-id="2fe08-132">Microsoft.VisualStudio.Tools.Applications.Runtime.dll</span><span class="sxs-lookup"><span data-stu-id="2fe08-132">Microsoft.VisualStudio.Tools.Applications.Runtime.dll</span></span>  
  
-   <span data-ttu-id="2fe08-133">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="2fe08-133">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#5](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#5)]
 [!code-vb[Trin_ServerDocument#5](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#5)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Schema">
      <MemberSignature Language="C#" Value="public string Schema { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Schema" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Schema" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="2fe08-134">如果缓存数据对象为 <see cref="T:System.Data.DataSet" /> 或 <see cref="T:System.Data.DataTable" />，获取或设置描述由 <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" /> 表示的缓存数据对象的架构。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2fe08-134">Gets or sets a schema that describes the cached data object that is represented by the <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" />, if the cached data object is a <see cref="T:System.Data.DataSet" /> or <see cref="T:System.Data.DataTable" />.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="2fe08-135">缓存的数据对象是否<see cref="T:System.Data.DataSet" />或<see cref="T:System.Data.DataTable" />，此属性返回的架构，用于描述缓存的数据对象中; 否则为<see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2fe08-135">If the cached data object is a <see cref="T:System.Data.DataSet" /> or <see cref="T:System.Data.DataTable" />, this property returns a schema that describes the cached data object; otherwise, <see langword="null" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="2fe08-136">有关演示如何使用的代码示例<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Schema%2A>属性，请参阅[ServerDocument 示例](http://msdn.microsoft.com/en-us/4d5a9093-d648-4c66-a182-65bebf6016d7)。</span><span class="sxs-lookup"><span data-stu-id="2fe08-136">For a code example that demonstrates how to use the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Schema%2A> property, see [ServerDocument Sample](http://msdn.microsoft.com/en-us/4d5a9093-d648-4c66-a182-65bebf6016d7).</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="SerializeDataInstance">
      <MemberSignature Language="C#" Value="public void SerializeDataInstance (object value);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SerializeDataInstance(object value) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance(System.Object)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="value" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="value">
          <span data-ttu-id="2fe08-137">该对象包含要保存到数据缓存中的对象的数据。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2fe08-137">The object that contains the data you want to save to an object in the data cache.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="2fe08-138">将数据序列化为通过 <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" /> 表示的缓存数据对象。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2fe08-138">Serializes data to the cached data object that is represented by the <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2fe08-139">使用<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A>方法以初始化或修改的缓存的数据对象的值。</span><span class="sxs-lookup"><span data-stu-id="2fe08-139">Use the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A> method to initialize or modify the value of a cached data object.</span></span> <span data-ttu-id="2fe08-140">此方法序列化`value`到缓存的数据的参数对象<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem>表示。</span><span class="sxs-lookup"><span data-stu-id="2fe08-140">This method serializes the `value` parameter into the cached data object that the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem> represents.</span></span> <span data-ttu-id="2fe08-141">如对复杂的缓存的数据对象中的特定数据值进行更改<xref:System.Data.DataSet>或<xref:System.Data.DataTable>、 反序列化的 XML 表示形式的缓存数据到缓存的对象的新实例，对此副本进行的更改以及如何将<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A>方法以序列化所做的更改回数据缓存。</span><span class="sxs-lookup"><span data-stu-id="2fe08-141">To make changes to specific data values in a complex cached data object, such as a <xref:System.Data.DataSet> or <xref:System.Data.DataTable>, deserialize the XML representation of the cached data into a new instance of the cached object, make the changes to this copy, and then use the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A> method to serialize the changes back into the data cache.</span></span> <span data-ttu-id="2fe08-142">有关详细信息，请参阅[在服务器上的文档中访问数据](/visualstudio/vsto/accessing-data-in-documents-on-the-server)和[演练： 更改服务器上的工作簿中的缓存数据](/visualstudio/vsto/walkthrough-changing-cached-data-in-a-workbook-on-a-server)。</span><span class="sxs-lookup"><span data-stu-id="2fe08-142">For more information, see [Accessing Data in Documents on the Server](/visualstudio/vsto/accessing-data-in-documents-on-the-server) and [Walkthrough: Changing Cached Data in a Workbook on a Server](/visualstudio/vsto/walkthrough-changing-cached-data-in-a-workbook-on-a-server).</span></span>  
  
 <span data-ttu-id="2fe08-143">此方法使用 DiffGram 格式来序列化<xref:System.Data.DataSet>， <xref:System.Data.DataTable>，和类型的数据缓存到数据集对象。</span><span class="sxs-lookup"><span data-stu-id="2fe08-143">This method uses the DiffGram format for serializing <xref:System.Data.DataSet>, <xref:System.Data.DataTable>, and typed dataset objects into the data cache.</span></span> <span data-ttu-id="2fe08-144">这可确保更改脱机文档中的数据缓存正确发送到服务器。</span><span class="sxs-lookup"><span data-stu-id="2fe08-144">This ensures that changes to the data cache in an offline document are sent to the server correctly.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2fe08-145">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A>方法来修改 Excel 工作簿的工作表中缓存的字符串的值。</span><span class="sxs-lookup"><span data-stu-id="2fe08-145">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A> method to modify the value of a string that is cached in a worksheet of an Excel workbook.</span></span>  
  
 <span data-ttu-id="2fe08-146">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="2fe08-146">This example requires:</span></span>  
  
-   <span data-ttu-id="2fe08-147">具有的 Excel 文档级自定义`Sheet1`类中`ExcelWorkbook1`命名空间，并在已缓存的字符串`Sheet1`类名为`CachedString`。</span><span class="sxs-lookup"><span data-stu-id="2fe08-147">A document-level customization for Excel that has a `Sheet1` class in the `ExcelWorkbook1` namespace, and a cached string in the `Sheet1` class named `CachedString`.</span></span>  
  
-   <span data-ttu-id="2fe08-148">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="2fe08-148">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="2fe08-149">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="2fe08-149">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="2fe08-150">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll</span><span class="sxs-lookup"><span data-stu-id="2fe08-150">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll</span></span>  
  
    -   <span data-ttu-id="2fe08-151">Microsoft.VisualStudio.Tools.Applications.Runtime.dll</span><span class="sxs-lookup"><span data-stu-id="2fe08-151">Microsoft.VisualStudio.Tools.Applications.Runtime.dll</span></span>  
  
-   <span data-ttu-id="2fe08-152">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="2fe08-152">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#9](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#9)]
 [!code-vb[Trin_ServerDocument#9](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#9)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Xml">
      <MemberSignature Language="C#" Value="public string Xml { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Xml" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Xml" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualStudio.Tools.Applications.ServerDocument</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="2fe08-153">获取或设置由 <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" /> 表示的缓存数据对象的 XML 表示形式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2fe08-153">Gets or sets the XML representation of the cached data object that is represented by the <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" />.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="2fe08-154">缓存的数据对象所表示的 XML 表示形式<see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="2fe08-154">The XML representation of the cached data object that is represented by the <see cref="T:Microsoft.VisualStudio.Tools.Applications.CachedDataItem" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="2fe08-155">若要获取的缓存的数据对象的值，请使用<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Xml%2A>属性进行反序列化的 XML 表示形式的缓存数据到缓存的数据对象的新实例。</span><span class="sxs-lookup"><span data-stu-id="2fe08-155">To get the value of a cached data object, use the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Xml%2A> property to deserialize the XML representation of the cached data into a new instance of the cached data object.</span></span> <span data-ttu-id="2fe08-156">然后，您可以对此副本所做的更改和序列化更改都应用到数据缓存。</span><span class="sxs-lookup"><span data-stu-id="2fe08-156">You can then make changes to this copy and serialize the changes back into the data cache.</span></span>  
  
 <span data-ttu-id="2fe08-157">在大多数情况下，可以使用<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A>方法已更改的对象序列化到的数据缓存。</span><span class="sxs-lookup"><span data-stu-id="2fe08-157">In most cases, you can use the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.SerializeDataInstance%2A> method to serialize the changed object into the data cache.</span></span> <span data-ttu-id="2fe08-158">如果你想要对缓存数据的更改执行你自己的序列化，您还可以编写直接向<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Xml%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="2fe08-158">If you want to perform your own serialization for changes to cached data, you can also write directly to the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Xml%2A> property.</span></span> <span data-ttu-id="2fe08-159">但是，如果要进行更改<xref:System.Data.DataSet>， <xref:System.Data.DataTable>，或将使用更新到数据库的类型化数据集<xref:System.Data.Common.DataAdapter>，所做的更改写入缓存的数据时指定 DiffGram 格式。</span><span class="sxs-lookup"><span data-stu-id="2fe08-159">However, if you are making changes to a <xref:System.Data.DataSet>, <xref:System.Data.DataTable>, or a typed dataset that will be updated to a database by using a <xref:System.Data.Common.DataAdapter>, specify the DiffGram format when you write the changes to the cached data.</span></span> <span data-ttu-id="2fe08-160">否则为对更改<xref:System.Data.DataSet>或<xref:System.Data.DataTable>将添加到数据库而不是已更改的行的新行。</span><span class="sxs-lookup"><span data-stu-id="2fe08-160">Otherwise, the changes to the <xref:System.Data.DataSet> or <xref:System.Data.DataTable> will be added to the database as new rows instead of changed rows.</span></span> <span data-ttu-id="2fe08-161">有关详细信息，请参阅[在服务器上的文档中访问数据](/visualstudio/vsto/accessing-data-in-documents-on-the-server)。</span><span class="sxs-lookup"><span data-stu-id="2fe08-161">For more information, see [Accessing Data in Documents on the Server](/visualstudio/vsto/accessing-data-in-documents-on-the-server).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="2fe08-162">下面的代码示例使用<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Xml%2A>属性来获取缓存中的 Excel 工作簿的工作表的字符串值。</span><span class="sxs-lookup"><span data-stu-id="2fe08-162">The following code example uses the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Xml%2A> property to get the value of a string that is cached in a worksheet of an Excel workbook.</span></span> <span data-ttu-id="2fe08-163">该示例在一个消息框中显示的值。</span><span class="sxs-lookup"><span data-stu-id="2fe08-163">The example displays the value in a message box.</span></span>  
  
 <span data-ttu-id="2fe08-164">此示例需要：</span><span class="sxs-lookup"><span data-stu-id="2fe08-164">This example requires:</span></span>  
  
-   <span data-ttu-id="2fe08-165">具有的 Excel 文档级自定义`Sheet1`类中`ExcelWorkbook1`命名空间，并在已缓存的字符串`Sheet1`类名为`CachedString`。</span><span class="sxs-lookup"><span data-stu-id="2fe08-165">A document-level customization for Excel that has a `Sheet1` class in the `ExcelWorkbook1` namespace, and a cached string in the `Sheet1` class named `CachedString`.</span></span>  
  
-   <span data-ttu-id="2fe08-166">控制台应用程序项目或某些其他非 Office 项目。</span><span class="sxs-lookup"><span data-stu-id="2fe08-166">A console application project or some other non-Office project.</span></span>  
  
-   <span data-ttu-id="2fe08-167">对以下程序集的引用：</span><span class="sxs-lookup"><span data-stu-id="2fe08-167">References to the following assemblies:</span></span>  
  
    -   <span data-ttu-id="2fe08-168">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll</span><span class="sxs-lookup"><span data-stu-id="2fe08-168">Microsoft.VisualStudio.Tools.Applications.ServerDocument.dll</span></span>  
  
    -   <span data-ttu-id="2fe08-169">Microsoft.VisualStudio.Tools.Applications.Runtime.dll</span><span class="sxs-lookup"><span data-stu-id="2fe08-169">Microsoft.VisualStudio.Tools.Applications.Runtime.dll</span></span>  
  
-   <span data-ttu-id="2fe08-170">`Imports` （对于 Visual Basic) 或`using`（适用于 C#) 语句<xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName>和<xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName>代码文件顶部的命名空间。</span><span class="sxs-lookup"><span data-stu-id="2fe08-170">`Imports` (for Visual Basic) or `using` (for C#) statements for <xref:Microsoft.VisualStudio.Tools.Applications?displayProperty=fullName> and <xref:Microsoft.VisualStudio.Tools.Applications.Runtime?displayProperty=fullName> namespaces at the top of your code file.</span></span>  
  
 [!code-csharp[Trin_ServerDocument#10](~/snippets/csharp/VS_Snippets_OfficeSP/Trin_ServerDocument/CS/Form1.cs#10)]
 [!code-vb[Trin_ServerDocument#10](~/snippets/visualbasic/VS_Snippets_OfficeSP/Trin_ServerDocument/VB/Form1.vb#10)]  
  
 <span data-ttu-id="2fe08-171">有关演示如何使用的代码示例<xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Xml%2A>属性来修改和序列化对缓存的更改<xref:System.Data.DataSet>，请参阅[演练： 更改服务器上的工作簿中的缓存数据](/visualstudio/vsto/walkthrough-changing-cached-data-in-a-workbook-on-a-server)。</span><span class="sxs-lookup"><span data-stu-id="2fe08-171">For a code example that demonstrates how to use the <xref:Microsoft.VisualStudio.Tools.Applications.CachedDataItem.Xml%2A> property to modify and serialize changes to a cached <xref:System.Data.DataSet>, see [Walkthrough: Changing Cached Data in a Workbook on a Server](/visualstudio/vsto/walkthrough-changing-cached-data-in-a-workbook-on-a-server).</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>